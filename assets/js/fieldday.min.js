var fieldday;!function(e){let a;var t,s,i,r,n,o,d,_,l,m,c,p,u,k,f,h,g;(fieldday={settings:{loader:'<div class="km_loader_full"></div>',spinnerInline:'<i class="fa fa-spinner fa-spin wpforms-loading-inline"></i>',DaysArray:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],allCountries:{93:"af",355:"al",213:"dz",1:"us",376:"ad",244:"ao",54:"ar",374:"am",297:"aw",61:"cc",43:"at",994:"az",973:"bh",880:"bd",375:"by",32:"be",501:"bz",229:"bj",975:"bt",591:"bo",387:"ba",267:"bw",55:"br",246:"io",673:"bn",359:"bg",226:"bf",257:"bi",855:"kh",237:"cm",238:"cv",599:"cw",236:"cf",235:"td",56:"cl",86:"cn",57:"co",269:"km",243:"cd",242:"cg",682:"ck",506:"cr",225:"ci",385:"hr",53:"cu",357:"cy",420:"cz",45:"dk",253:"dj",593:"ec",20:"eg",503:"sv",240:"gq",291:"er",372:"ee",251:"et",500:"fk",298:"fo",679:"fj",358:"ax",33:"fr",594:"gf",689:"pf",241:"ga",220:"gm",995:"ge",49:"de",233:"gh",350:"gi",30:"gr",299:"gl",590:"mf",502:"gt",44:"gb",224:"gn",245:"gw",592:"gy",509:"ht",504:"hn",852:"hk",36:"hu",354:"is",91:"in",62:"id",98:"ir",964:"iq",353:"ie",972:"il",39:"va",81:"jp",962:"jo",7:"ru",254:"ke",686:"ki",383:"xk",965:"kw",996:"kg",856:"la",371:"lv",961:"lb",266:"ls",231:"lr",218:"ly",423:"li",370:"lt",352:"lu",853:"mo",389:"mk",261:"mg",265:"mw",60:"my",960:"mv",223:"ml",356:"mt",692:"mh",596:"mq",222:"mr",230:"mu",262:"re",52:"mx",691:"fm",373:"md",377:"mc",976:"mn",382:"me",212:"eh",258:"mz",95:"mm",264:"na",674:"nr",977:"np",31:"nl",687:"nc",64:"nz",505:"ni",227:"ne",234:"ng",683:"nu",672:"nf",850:"kp",47:"sj",968:"om",92:"pk",680:"pw",970:"ps",507:"pa",675:"pg",595:"py",51:"pe",63:"ph",48:"pl",351:"pt",974:"qa",40:"ro",250:"rw",290:"sh",508:"pm",685:"ws",378:"sm",239:"st",966:"sa",221:"sn",381:"rs",248:"sc",232:"sl",65:"sg",421:"sk",386:"si",677:"sb",252:"so",27:"za",82:"kr",211:"ss",34:"es",94:"lk",249:"sd",597:"sr",268:"sz",46:"se",41:"ch",963:"sy",886:"tw",992:"tj",255:"tz",66:"th",670:"tl",228:"tg",690:"tk",676:"to",216:"tn",90:"tr",993:"tm",688:"tv",256:"ug",380:"ua",971:"ae",598:"uy",998:"uz",678:"vu",58:"ve",84:"vn",681:"wf",967:"ye",260:"zm",263:"zw"},parsley_valiation_options:{trigger:"change",successClass:"has-success",errorClass:"has-error",classHandler:function(e){return e.$element.closest("fieldset")},errorsWrapper:'<div class="km_invalid_message"></div>',errorTemplate:"<span></span>"},parsley_valiation_options_register:{trigger:"change",successClass:"has-success",errorClass:"has-error",classHandler:function(e){return e.$element.closest("fieldset")},errorsWrapper:'<div class="km_auth_invalid_message"></div>',errorTemplate:"<span></span>"}},initilaize:function(){t=fieldday,s=0,n=120,i=!0,1,5,o=fieldday_ajax.isKmUser,e(document).ready(function(){t.onInitMethods()}),t.ClearSessionFilters(".km_filter_form")},onInitMethods:function(){t.FilterSessions(),t.BookingSelection(),t.BookingCalander(),t.MultiWeekBookingCalander(),t.fielddaySessionTime(),t.InitSessionFilter(),t.PhoneInput(),t.DateInput(),t.CardInput(),t.triggerModal(),t.handleQueryParam(),t.atc_cart_steps(),t.requiredfields(),t.inputincrement(),t.checkoutpageevents(),t.merchandiseevents(),t.kidspageevents(),t.SessionlistVeiw(),t.km_get_utc_string_func(),t.Myaccountpageevents(),t.getTimezoneOffset(),t.kmTooltip(),t.otpEvents(),t.fielddaySelect(),t.hasCart(),t.countItmeCart(),t.initilaizeDaterangepicker(),t.ModalCalander(),t.giftCardswitchevent(),t.passwordHideShowevent(),t.FilterMobile(),t.AddressAutoComplete(),t.ActivePurchasetab(),t.scrollTo(),t.StickyformVisibility(),t.initSlickSlider(),t.LocationPopUpformVisibility(),Stripe.setPublishableKey(fieldday_ajax.fieldday_stripe_token),t.paymentrequired=!1,"bank_days"==document.URL.split("=")[1]&&(e(".km_merchandise").attr("checked",!0),e(".km_merchandise").trigger("change"))},km_get_utc_string_func:function(){try{let e=new Date;return e.setUTCMinutes(e.getUTCMinutes()+2),`${e.getUTCHours()}:${e.getUTCMinutes()}:${e.getUTCSeconds()}`}catch(e){return"23:59:59"}},getDaysBetweenDates:function(e,a){for(var t=e.clone(),s=[];t.isSameOrBefore(a);)s.push(t.format("MM-DD-YYYY")),t.add(1,"days");return s},deleteUserAccountFieldday:function(){let e='#km_user_delete_account_form input[type="checkbox"]';if(jQuery(e+":checked").length!=jQuery(e).length)t.DisplayAlert("error","Please check all the checkboxes fields.");else if("DELETE"!=jQuery("#km_user_delete_account_form input[name='delete']").val())t.DisplayAlert("error","Type DELETE in the Textbox first.");else{var a=new FormData;t.postFormData(fieldday_ajax.ajax_url+"?action=km_user_delete",a,function(e){"success"==e.status?(console.log("successdata"),alert("in progress")):(t.kmRemoveLoader(),t.DisplayAlert("error",e.message))})}},FilterMobile:function(){jQuery(".km_mobile_filters").click(function(){jQuery("#km_session_search_container .km_filter_row.bottom_row , .km_filter_row.myrow.km_filters_change").toggleClass("km_mobile_hidden")})},AddressAutoComplete:function(){if(e("#address_autocomplete").length){var a=document.getElementById("address_autocomplete");new google.maps.places.Autocomplete(a)}e(".km_doctor_address").length&&e(".km_doctor_address").each(function(){var a=e(this).find("input.kmdoctorStreet").attr("id"),t=document.getElementById(a),s=e(this).find("input.kmdoctorpin").attr("id"),i=document.getElementById(s),r=e(this).find("input.kmdoctorState").attr("id"),n=document.getElementById(r),o=e(this).find("input.kmdoctorCity").attr("id"),d=document.getElementById(o),_=new google.maps.places.Autocomplete(t);google.maps.event.addListener(_,"place_changed",function(){for(var a=_.getPlace(),t=0;t<a.address_components.length;t++)for(var s=0;s<a.address_components[t].types.length;s++)"postal_code"==a.address_components[t].types[s]&&e(i).val(a.address_components[t].long_name),"administrative_area_level_1"==a.address_components[t].types[s]&&e(n).val(a.address_components[t].long_name),"locality"==a.address_components[t].types[s]&&e(d).val(a.address_components[t].long_name)})})},ActivePurchasetab:function(){var e=function(e){var a,t,s=window.location.search.substring(1).split("&");for(t=0;t<s.length;t++)if((a=s[t].split("="))[0]===e)return void 0===typeof a[1]||decodeURIComponent(a[1]);return!1}("tab");e&&jQuery(".km_radio_wrap[data-tab="+e+"]").find("input").trigger("click")},BookingSelection:function(){var a=e("#km_booking_radio_select").val();if(a&&"fullcamp"!=a&&(e(".km_cart_calender,.km_cart_calender_main").removeClass("km_hidden"),e("#DatesLabel").val())){var s=JSON.parse(e("#DatesLabel").val());if(""!=s){var i=Object.keys(s).length;if(i>0){if(1==i)var r="date selected";else r="dates selected";e(".km_dates_count").html("(<span>"+i+"</span> "+r+")")}else e(".km_dates_count").html("")}}e(document).on("change","#km_booking_radio_select",function(){let a=e("#km_booking_radio_select").val(),s=e("#km_booking_radio_select").find("option:selected"),i=jQuery("#DatesLabel").parent().find(".parsley-required"),r=jQuery(this).attr("data-date-from"),n=jQuery(this).attr("data-date-to"),o=fieldday.BookingAtcWaitlistReinitializeObject(r,n);if("fullcamp"==a||""==a){i.hide(),e(".km_input_extraoptions,.km_extra_additional").html(""),e(".km_cart_calender,.km_cart_calender_main,.km_calender").addClass("km_hidden"),e(".km_FullSessionextendedPrice").removeClass("km_hidden"),e(".km_perDayextendedPrice").addClass("km_hidden"),e(".km_installments").removeClass("km_hidden"),e(".km_installments input").attr("required","required"),e("#DatesLabel").removeAttr("required"),jQuery(".km_calander_div").multiDatesPicker("resetDates","picked"),jQuery("#DatesLabel").val(""),jQuery("#DatesTimeLabel").val(""),jQuery("#DatesTimeLabelAllDates").val(""),jQuery("#DatesTimeLabelAllDatesUtcFormat").val(""),jQuery("#DatesAvail").val(""),jQuery(".km_dates_count").html(""),jQuery(".km_selected_opt").remove();var d=s.attr("data-fullcamp-avail");e(".km_allowed_seats").attr("id",d),t.Extradata(),fieldday.CalanderAtcDestroySetButtons("default")}else{i.show(),e(".km_input_extraoptions,.km_extra_additional").html(""),e(".km_cart_calender,.km_cart_calender_main").removeClass("km_hidden"),e(".km_FullSessionextendedPrice").addClass("km_hidden"),e(".km_perDayextendedPrice").removeClass("km_hidden"),e(".km_installments").addClass("km_hidden"),e(".km_installments input").removeAttr("required"),e("#DatesLabel").attr("required","required");var _=s.attr("data-oneday-times");jQuery("#DatesTimeLabel").val(_);var l=s.attr("data-oneday-times-all-dates");jQuery("#DatesTimeLabelAllDates").val(l);l=s.attr("data-oneday-times-all-dates");jQuery("#DatesTimeLabelAllDates").val(l);var m=s.attr("data-oneday-times-all-dates-utc");jQuery("#DatesTimeLabelAllDatesUtcFormat").val(m),e("#DatesLabel").val(""),jQuery(".km_dates_count").html(""),jQuery(".km_onedayavail").html(""),o&&o.dates.length>0&&(jQuery(".km_calander_div").multiDatesPicker("resetDates","picked"),fieldday.BookingCalanderForAtcDestroy(o.dates[0],o.dates[o.dates.length-1])),fieldday.CalanderAtcDestroySetButtons("default")}})},BookingCalander:function(){e(document).on("click",".km_multidatepicker_date_trashIcon",function(){let a=e(this).parent().parent().find(".km_avail_content_dateOnly"),t=(e("#DatesLabel").val(),e("#km_booking_radio_select").find("option:selected").attr("data-oneday-avail")),s=JSON.parse(t);var i=new Array;if(a){let t=JSON.parse(e("#DatesLabel").val());if(a=a.text(),0==(t=t.filter(e=>e!==a)).length)e("#km_booking_radio_select").trigger("change");else{let n=JSON.stringify(t);e("#DatesLabel").val(n);let o=new Date(a);jQuery(".km_calander_div").multiDatesPicker("removeDates",o),e(".km_onedayavail").html(""),e.each(t,function(a,r){var n=void 0!==s[t[a]]?s[t[a]]:0;e(".km_onedayavail").append('<div class="km_selected_opt"><span class="km_avail_label">Date: </span><span class="km_avail_content  km_avail_content_dateOnly">'+t[a]+'</span><span class="km_avail_label">Available Seats: </span><span class="km_avail_content">'+n+'&nbsp;&nbsp;<i class="fa fa-trash km_primary_color km_multidatepicker_date_trashIcon" aria-hidden="true"></i></span></div>'),i.push(n)});let d=Math.min.apply(Math,i);e(".km_allowed_seats").attr("id",d);let _=t.length;if(_>0){if(1==_)var r="date selected";else r="dates selected";e(".km_dates_count").html("(<span>"+_+"</span> "+r+")")}else e(".km_dates_count").html("");fieldday.Extradata()}}}),e(".km_cart_calender").on("click",function(){e(this).next(".km_calender").toggleClass("km_hidden");var a=e(this).data("date-from"),t=e(this).data("date-to");fieldday.BookingAtcWaitlistReinitialize(a,t,"reset")})},BookingAtcWaitlistReinitializeObject:function(a,t,s="reset"){try{var i={};let a=new Array,t="",d=new Array,_=new Array,l=(new Array,""),m=new Array;var r=JSON.parse(e("#km_booking_radio_select").find("option:selected").attr("data-oneday-times-all-dates"));startDate=moment(Object.values(r)[0]),endDate=moment(Object.values(r)[Object.values(r).length-1]);let c=[];if(null!==r&&"object"==typeof r&&(c=Object.keys(r)),""!=e("#DatesLabel").val()){let a=JSON.parse(e("#DatesLabel").val());if(""!=a){let t=new Array;e.each(a,function(e,a){var s=new Date(a),i=jQuery.datepicker.formatDate("mm-dd-yy",s);t.push(i)})}}let p=e("#km_booking_radio_select").val();if("fullcamp"!=p&&""!=p){var n=e("#km_booking_radio_select").find("option:selected").attr("data-oneday-dates");if(n=JSON.parse(n),"halfDayMrng"==p){let a=e("#km_booking_radio_select option[value='halfDayMrng']").attr("data-waitlist-days-morning");d=JSON.parse(a)}else if("halfDayEvng"==p){let a=e("#km_booking_radio_select option[value='halfDayEvng']").attr("data-waitlist-days-evening");d=JSON.parse(a)}else"fullDay"==p&&(d=e("#km_booking_radio_select option[value='fullDay']").attr("data-waitlist-days"),d=JSON.parse(d));""!=n?(m=c.filter(function(e){return-1===d.indexOf(e)}),_=o?[...new Set([...m,...d])]:m,i.dates=_,i.atc=m,i.atw=d):o&&d&&d.length>0?(i.dates=d,i.atc=m,i.atw=d):(console.log("No Dates Found"),t=!0,i.dates=!1,i.atc=!1,i.atw=!1)}if(i.dates&&i.dates.length>0){"reset"==s?a="":"atw"==s?a=i.atc:"atc"==s&&(a=i.atw);let e=i.dates.sort((e,a)=>{let t=e.split("-"),s=a.split("-");return new Date(parseInt(t[2]),parseInt(t[0])-1,parseInt(t[1]))-new Date(parseInt(s[2]),parseInt(s[0])-1,parseInt(s[1]))});return i.minDate=new Date(e[0]),i.maxDate=new Date(e[e.length-1]),i.addDisabledDates=a,i.addDates=l,i.disabled=t,i}return console.log("No Dates Available"),!1}catch(e){return console.log(e),!1}},BookingAtcWaitlistReinitialize:function(a,s,i="reset"){try{var r,n={};let m=new Array,c="",p=new Array,u=new Array,k=(new Array,""),f=new Array;var d=JSON.parse(e("#km_booking_radio_select").find("option:selected").attr("data-oneday-times-all-dates"));startDate=moment(Object.values(d)[0]),endDate=moment(Object.values(d)[Object.values(d).length-1]);let h=[];if(null!==d&&"object"==typeof d&&(h=Object.keys(d)),""!=e("#DatesLabel").val()){let a=JSON.parse(e("#DatesLabel").val());if(""!=a){let t=new Array;e.each(a,function(e,a){var s=new Date(a),i=jQuery.datepicker.formatDate("mm-dd-yy",s);t.push(i)})}}let g=e("#km_booking_radio_select").val();if("fullcamp"!=g&&""!=g){var _=e("#km_booking_radio_select").find("option:selected").attr("data-oneday-dates");if(_=JSON.parse(_),"halfDayMrng"==g){let a=e("#km_booking_radio_select option[value='halfDayMrng']").attr("data-waitlist-days-morning");p=JSON.parse(a)}else if("halfDayEvng"==g){let a=e("#km_booking_radio_select option[value='halfDayEvng']").attr("data-waitlist-days-evening");p=JSON.parse(a)}else"fullDay"==g&&(p=e("#km_booking_radio_select option[value='fullDay']").attr("data-waitlist-days"),p=JSON.parse(p));""!=_?(f=h.filter(function(e){return-1===p.indexOf(e)}),u=o?[...new Set([...f,...p])]:f,n.dates=u,n.atc=f,n.atw=p):o&&p&&p.length>0?(n.dates=p,n.atc=f,n.atw=p):(console.log("No Dates Found"),c=!0,n.dates=!1,n.atc=!1,n.atw=!1)}if(n.dates&&n.dates.length>0){"reset"==i?m="":"atw"==i?m=n.atc:"atc"==i&&(m=n.atw);let o=n.dates.sort((e,a)=>e.localeCompare(a));n.minDate=new Date(o[0]),n.maxDate=new Date(o[o.length-1]),n.addDisabledDates=m,n.addDates=k,n.disabled=c,e(".km_calander_div").multiDatesPicker({dateFormat:"mm-dd-yy",minDate:new Date(n.dates[0]),maxDate:new Date(n.dates[n.dates.length-1]),addDisabledDates:m,addDates:k,disabled:c,onSelect:function(){var i=e(this).multiDatesPicker("getDates").length,o="";if(i>0){if(document.getElementById("DatesLabel"))jQuery("#DatesLabel").parent().find(".parsley-required").hide();var d=JSON.stringify(e(this).multiDatesPicker("getDates"));e("#DatesLabel").val(d)}else{if(document.getElementById("DatesLabel"))jQuery("#DatesLabel").parent().find(".parsley-required").show();d="";e("#DatesLabel").val("")}e(".km_onedayavail").html("");var _=e("#km_booking_radio_select").find("option:selected").attr("data-oneday-avail"),l=JSON.parse(_),m=new Array;if(d&&""!=d){var c=JSON.parse(e("#DatesLabel").val());1==e(this).multiDatesPicker("getDates").length?p.includes(c[0])?(r="atw","atw",fieldday.BookingAtcWaitlistReinitialize(a,s,r),fieldday.CalanderAtcDestroySetButtons("atw")):(r="atc","atc",fieldday.BookingAtcWaitlistReinitialize(a,s,r),fieldday.CalanderAtcDestroySetButtons("atc")):0==e(this).multiDatesPicker("getDates").length?(r="reset","reset",jQuery(".km_calander_div").multiDatesPicker("resetDates","picked"),fieldday.BookingCalanderForAtcDestroy(n.dates[0],n.dates[n.dates.length-1]),fieldday.CalanderAtcDestroySetButtons("default")):(p.includes(c[0])?(r="atw","atw"):(r="atc",fieldday.CalanderAtcDestroySetButtons("atc")),fieldday.BookingAtcWaitlistReinitialize(a,s,r)),""!=c&&e.each(c,function(a,t){var s=void 0!==l[c[a]]?l[c[a]]:0;e(".km_onedayavail").append('<div class="km_selected_opt"><span class="km_avail_label">Date: </span><span class="km_avail_content  km_avail_content_dateOnly">'+c[a]+'</span><span class="km_avail_label">Available Seats: </span><span class="km_avail_content">'+s+'&nbsp;&nbsp;<i class="fa fa-trash km_primary_color km_multidatepicker_date_trashIcon" aria-hidden="true"></i></span></div>'),m.push(s)});var u=Math.min.apply(Math,m);e(".km_allowed_seats").attr("id",u)}else jQuery(".km_calander_div").multiDatesPicker("resetDates","picked"),fieldday.BookingCalanderForAtcDestroy(n.dates[0],n.dates[n.dates.length-1]);if(t.Extradata(),i>0){if(1==i)o="date selected";else o="dates selected";e(".km_dates_count").html("(<span>"+i+"</span> "+o+")")}else e(".km_dates_count").html("")}});var l=e(".km_cal_close").detach();e(".km_calander_div").append(l),e(".km_cal_close").click(function(){e(this).parents(".km_calender").addClass("km_hidden")})}else console.log("No dates Available")}catch(e){console.log(e)}},BookingCalanderForAtcDestroy:function(a,s){var i=JSON.parse(e("#km_booking_radio_select").find("option:selected").attr("data-oneday-times-all-dates"));void 0!==i[a]&&(a=i[a]),void 0!==i[s]&&(s=i[s]);let r=fieldday.BookingAtcWaitlistReinitializeObject(a,s).atw;jQuery(".km_calander_div").multiDatesPicker("destroy").multiDatesPicker({dateFormat:"mm-dd-yy",minDate:new Date(a),maxDate:new Date(s),onSelect:function(i,n){var o=e(this).multiDatesPicker("getDates").length,d="";if(o>0){if(document.getElementById("DatesLabel"))jQuery("#DatesLabel").parent().find(".parsley-required").hide();var _=JSON.stringify(e(this).multiDatesPicker("getDates"));e("#DatesLabel").val(_)}else{if(document.getElementById("DatesLabel"))jQuery("#DatesLabel").parent().find(".parsley-required").show();_="";e("#DatesLabel").val(""),fieldday.CalanderAtcDestroySetButtons("default")}e(".km_onedayavail").html("");var l=e("#km_booking_radio_select").find("option:selected").attr("data-oneday-avail"),m=JSON.parse(l),c=new Array;if(_&&""!=_){var p=JSON.parse(e("#DatesLabel").val());""!=p&&e.each(p,function(a,t){var s=m[p[a]];e(".km_onedayavail").append('<div class="km_selected_opt"><span class="km_avail_label">Date: </span><span class="km_avail_content km_avail_content_dateOnly">'+p[a]+'</span><span class="km_avail_label">Available Seats: </span><span class="km_avail_content">'+s+'&nbsp;&nbsp;<i class="fa fa-trash km_primary_color  km_multidatepicker_date_trashIcon" aria-hidden="true"></i></span></div>'),c.push(s)});var u=Math.min.apply(Math,c);e(".km_allowed_seats").attr("id",u)}let k=e(this).val();if(r&&r.length>0&&r.includes(k)?(typeOfRequest="atw",fieldday.BookingAtcWaitlistReinitialize(a,s,typeOfRequest),fieldday.CalanderAtcDestroySetButtons("atw")):(typeOfRequest="atc",fieldday.BookingAtcWaitlistReinitialize(a,s,typeOfRequest),fieldday.CalanderAtcDestroySetButtons("atc")),t.Extradata(),o>0){if(1==o)d="date selected";else d="dates selected";e(".km_dates_count").html("(<span>"+o+"</span> "+d+")")}else e(".km_dates_count").html("")}})},CalanderAtcDestroySetButtons:function(a="default"){let t=e("#KmSessionBookingStatus").val();"atc"==a?(e("#km_session_add_to_cart_pc").hasClass("km_add_to_cart")||e("#km_session_add_to_cart_pc").addClass("km_add_to_cart"),e("#km_session_add_to_cart_pc").hasClass("km_add_to_waitlist")&&e("#km_session_add_to_cart_pc").removeClass("km_add_to_waitlist"),e("#km_session_add_to_cart_pc").text("Add To Cart"),e("#DatesTimeLabel").val(e("#DatesTimeLabel").val()),o&&e(".km_new_checkout_btn_add_to_cart_form").show()):"atw"==a&&o?(e("#km_session_add_to_cart_pc").hasClass("km_add_to_cart")&&e("#km_session_add_to_cart_pc").removeClass("km_add_to_cart"),e("#km_session_add_to_cart_pc").hasClass("km_add_to_waitlist")||e("#km_session_add_to_cart_pc").addClass("km_add_to_waitlist"),e("#km_session_add_to_cart_pc").text("Add To Waitlist"),o&&e(".km_new_checkout_btn_add_to_cart_form").hide(),e("#DatesTimeLabel").val(e("#DatesTimeLabelAllDates").val())):"open"==t?(e("#km_session_add_to_cart_pc").hasClass("km_add_to_cart")||e("#km_session_add_to_cart_pc").addClass("km_add_to_cart"),e("#km_session_add_to_cart_pc").hasClass("km_add_to_waitlist")&&e("#km_session_add_to_cart_pc").removeClass("km_add_to_waitlist"),e("#km_session_add_to_cart_pc").text("Add To Cart"),e("#DatesTimeLabel").val(e("#DatesTimeLabel").val()),o&&e(".km_new_checkout_btn_add_to_cart_form").show()):"waitlist"==t&&o?(e("#km_session_add_to_cart_pc").hasClass("km_add_to_cart")&&e("#km_session_add_to_cart_pc").removeClass("km_add_to_cart"),e("#km_session_add_to_cart_pc").hasClass("km_add_to_waitlist")||e("#km_session_add_to_cart_pc").addClass("km_add_to_waitlist"),e("#km_session_add_to_cart_pc").text("Add To Waitlist"),e("#DatesTimeLabel").val(e("#DatesTimeLabelAllDates").val()),o&&e(".km_new_checkout_btn_add_to_cart_form").hide()):(e("#km_session_add_to_cart_pc").hasClass("km_add_to_cart")||e("#km_session_add_to_cart_pc").addClass("km_add_to_cart"),e("#km_session_add_to_cart_pc").hasClass("km_add_to_waitlist")&&e("#km_session_add_to_cart_pc").removeClass("km_add_to_waitlist"),e("#km_session_add_to_cart_pc").text("Add To Cart"),e("#DatesTimeLabel").val(e("#DatesTimeLabel").val()),o&&e(".km_new_checkout_btn_add_to_cart_form").show())},MultiWeekBookingCalander:function(){e(".km_multiweek_calander").on("click",function(){e(this).next(".km_calender").toggleClass("km_hidden");var a=e(this).data("date-from"),s=e(this).data("date-to"),i=e(this).data("weekdays"),r=e(this).data("midweekbooking"),n=e(this).data("excluded-dates"),o=moment(a),d=moment(s),_=new Array,l=t.getDaysBetweenDates(o,d);if(e.each(l,function(a,s){var i=new Date,o=(jQuery.datepicker.formatDate("mm-dd-yy",i),new Date(s)),d=jQuery.datepicker.formatDate("mm-dd-yy",o);if(o<i&&_.push(d),1!==r){var l=moment().startOf("week").toDate(),m=moment().endOf("week").toDate(),c=t.getDaysBetweenDates(moment(l),moment(m));e.each(c,function(e,a){var t=new Date,s=(jQuery.datepicker.formatDate("mm-dd-yy",t),new Date(a)),i=jQuery.datepicker.formatDate("mm-dd-yy",s);s<t||_.push(i)})}""!=n&&e.each(n,function(e,a){var t=new Date(a),s=jQuery.datepicker.formatDate("mm-dd-yy",t);_.push(s)})}),0===_.length)_="";e(".km_multiweek_calander_div").datepicker({format:"mm-dd-yy",minDate:new Date(a),maxDate:new Date(s),beforeShowDay:function(e){var a=jQuery.datepicker.formatDate("mm-dd-yy",e),t=e.getDay(),s=JSON.stringify(i);return-1===_.indexOf(a)?-1===s.indexOf(t)?[!1,"somecssclass"]:[!0,"someothercssclass"]:[!1,"somecssclass"]},onSelect:function(a){var s=e(this).datepicker("getDate"),i=jQuery.datepicker.formatDate("mm-dd-yy",s),r=jQuery.datepicker.formatDate("d-M-yy",s);e("#StartingDate").val(i);var n="";if(e("#StartingDate").val()){n="Selected";e(".kmdaterequired").text(""),e(".km_dates_count").html("(<span>"+r+"</span> "+n+")")}else e(".km_dates_count").html("");t.MultiweekExtradata()}});var m=e(".km_cal_close").detach();e(".km_multiweek_calander_div").append(m),e(".km_cal_close").click(function(){e(this).parents(".km_calender").addClass("km_hidden")})})},ModalCalander:function(){e(".km_datepicker").on("click",function(){let a=e(this).data("modal-heading");var s=e(this).data("date-from"),i=e(this).data("date-to");t.displayModal({header:a,content:"<div class='km_calander_div'></div>",footer:""});var r=moment(s),n=moment(i),o=t.getDaysBetweenDates(r,n);e(".km_calander_div").datepicker({format:"mm-dd-yyyy",minDate:new Date(s),maxDate:new Date(i),beforeShowDay:function(e){for(var a=e.getFullYear(),t=e.getMonth(),s=e.getDate(),i=0;i<o.length;++i){let e=new Date(o[i]);if(a==e.getFullYear()&&t==e.getMonth()-1&&s==e.getDate())return[!0,"ui-state-highlight ui-state-active"]}return[!1]}})})},Extradata:function(){var a=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_sessions_extradata",a,function(a){"success"==a.status&&(""!=a.data?(e(".km_input_extraoptions").html(a.data),e(".km_input_extraoptions").show()):e(".km_input_extraoptions").hide(),""!=a.additionaldata?(e(".km_extra_additional").html(a.additionaldata),e(".km_extra_additional").show()):e(".km_extra_additional").hide())})},MultiweekExtradata:function(){var a=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_multiweek_calculations",a,function(a){if(console.log(a),"success"==a.status){var t=moment(a.data.nextPaymentOn).format("MMM Do, YYYY");e(".km_due_today .km_date_value").text("$"+a.data.totalAmount);var s="$"+a.data.payableAmount;if(a.data.totalAmount!=a.data.payableAmount)s="<strike>$"+a.data.totalAmount+"</strike>$"+a.data.payableAmount;e(".km_total_due .km_date_value").html(s),e(".km_next_payment .km_date_value").text(t),e(".km_weeks_remaining .km_date_title").text(a.data.remainingWeeks+" Weeks Remaining"),e(".km_weeks_remaining .km_date_value").text(a.data.session.paymentFrequency+" - $"+a.data.nextPaymentAmount+"/seat"),e(".km_due").removeClass("km_hidden");var i=moment(a.data.nextBookingDate).format("MMM Do, YYYY");e(".km_joiningdate .km_date_value").html("<b>"+i+"</b>"),e(".km_joiningdate").show(),""!=a.data.autoRenewalRequired&&e(".km_renewal").removeClass("km_hidden"),a.data.payableAmount?e(".paymentMethod").val("card"):e(".paymentMethod").val("free")}})},triggerModal:function(){e(".km_modal_link").on("click",function(a){a.preventDefault();let s=e(this).data("title"),i=e(this).data("description");t.displayModal({header:s,content:"<div class='km_wrapped_content'>"+i+"</div>"},"km_modal_small km_custom_trigger_popup")})},kmTooltip:function(){e(".km_session_location").mouseenter(function(){e(this).next(".km_sessions_description").show()}),e(".km_session_location").mouseleave(function(){e(this).next(".km_sessions_description").hide()}),e(document).on("mouseenter",".km_tooltip",function(){var a=e(this).data("tooltip-title");e(this).append("<i>"+a+"</i>")}),e(document).on("mouseleave",".km_tooltip",function(){e(".km_tooltip i").remove()})},handleQueryParam:function(){if(u=t.GetQueryString("state")){k=t.GetQueryString("code");var a=u.split("_"),s=window.location.href.toString();if(s.indexOf("?")>0){var i=s.substring(0,s.indexOf("?"));window.history.replaceState({},document.title,i)}"facebook"==a[0]?t.LoginWithFacebook():"google"==a[0]&&t.LoginWithGoogle()}let r=t.GetQueryString("sessionId"),n=t.GetQueryString("type");n&&r?"event"==n?o?t.registerEvent(r,"event"):t.showAuthPopupNew(r):"session"==n?o?t.registerSession(r,"","",""):t.showAuthPopupNew(r):t.viewSessionDetail(r,"general"):r&&t.viewSessionDetail(r,"general"),e("#km_modal .km_cart_button_p.km_detail_bookbtn a").click();let d=t.GetQueryString("session");d&&(document.cookie="sessionclicked=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",e('a[data-click="'+d+'"]').click())},fielddaySelect:function(){e(".fieldday_select").select2()},fielddaySelectDestroy:function(){e(".fieldday_select").select2("destroy")},requiredfields:function(){e("input[required]:not(.optional), select[required]:not(.optional), textarea[required]:not(.optional)").each(function(){e(this).parents(".km_field_wrap").addClass("required_field")})},closepopup:function(){e(".fieldday_select").select2("destroy"),e("#km_modal").hide(),e("body").removeClass("body_km_open_true"),e("#km_modal .km_modal_heading, #km_modal .km_modal_content, #km_modal .km_modal_footer").html(""),t.GetQueryString("sessionId")&&t.removeQueryParam("sessionId")},closeSecpopup:function(){e("#km_modal_sec").hide(),e("#km_modal_sec .km_modal_heading, #km_modal_sec .km_modal_content, #km_modal_sec .km_modal_footer").html(""),t.GetQueryString("sessionId")&&t.removeQueryParam("sessionId")},closediscountpopup:function(a){e(a).parents(".km_modal").hide()},showAuthPopup:function(a,s){o&&location.reload(),s.preventDefault();var i=e(a).data("isguest"),r={action:"km_display_auth",isGuest:i},n=e(a).data("session-id"),d=e(a).data("ispackage"),u=e(a).data("type"),k=e(a).data("session-featured"),f=e(a).data("offer-id"),v=e(a).data("offer-name");if(n){var y=e(a).data("tag-id"),w=e(a).data("session-date");r.session_id=n,r.tagId=y,r.session_date=w,r.session_type=u,r.sessionfeatured=k,r.isGuest=i,r.Ispackage=d,_=n,h=d,g=u,l=y,m=w,n,t.setCookie("sessionclicked",n)}f&&(r.offerId=f,r.offername=v,c=f,p=v),t.makeCall(fieldday_ajax.ajax_url,r,function(e){t.displayModal(e,"modal-large km_auth_pop_up_modal_cls")})},showAuthPopupNew:function(e){var a={action:"km_display_auth"};_=e,e,a.session_id=e,t.setCookie("sessionclicked",e),t.makeCall(fieldday_ajax.ajax_url,a,function(e){t.displayModal(e,"modal-large km_auth_pop_up_modal_cls")})},showLoginForm:function(a,s){o&&location.reload(),s.preventDefault();var i=e(a).data("session-featured"),r=e(a).data("session-date"),n=e(a).data("type"),u={action:"km_display_login",sessionfeatured:i,session_date:r,session_type:n,isGuest:e(a).data("session-isguest")},k=e(a).data("session-id"),f=e(a).data("offer-id"),h=e(a).data("offer-name");i=e(a).data("session-featured");if(k){var v=e(a).data("tag-id");r=e(a).data("session-date");u.session_id=k,u.tagId=v,u.session_date=r,u.sessionfeatured=i,_=k,l=v,g=n,m=r}f&&(u.offerId=f,u.offername=h,c=f,p=h),t.makeCall(fieldday_ajax.ajax_url,u,function(a){t.displayModal(a,"modal-large"),e(".km_modal_content .km_login_wrap").addClass("km_ajax_login"),e(".km_signup_wrap:not(.km_ajax_signup_wrap)").hide(),e(".km_ajax_signup_wrap").removeClass("km_hidden"),d=grecaptcha.render("g-recaptcha",{sitekey:fieldday_ajax.g_sitekey})})},showRegisterForm:function(a,s){var i={action:"km_display_register"},r=e(a).data("session-id"),n=e(a).data("offer-id"),o=e(a).data("offer-name"),u=e(a).data("session-featured");if(r){var k=e(a).data("tag-id"),f=e(a).data("session-date");i.session_id=r,i.tagId=k,i.session_date=f,i.session_date=u,_=r,l=k,m=f}n&&(i.offerId=n,i.offername=o,c=n,p=o),t.makeCall(fieldday_ajax.ajax_url,i,function(a){t.displayModal(a,"modal-large modal-register-popup"),e(".km_modal_content .km_register_wrap").addClass("km_ajax_register"),e(".km_signup_wrap:not(.km_ajax_signup_wrap)").hide(),e(".km_ajax_signup_wrap").removeClass("km_hidden"),t.PhoneInput(),d=grecaptcha.render("g-recaptcha",{sitekey:fieldday_ajax.g_sitekey})})},showForgetPassword:function(){t.makeCall(fieldday_ajax.ajax_url,{action:"km_forget_popup"},function(e){"success"==e.status?t.displayModal(e,"modal-normal"):t.DisplayAlert("error",e.message)})},forgetPassword:function(a,s){s.preventDefault(),e("#km_forget_password").parsley(t.settings.parsley_valiation_options).whenValidate({group:"forgetPassword"}).done(function(){var s=new FormData(e("#km_forget_password")[0]);e(a).prop("disabled",!0),t.postFormData(fieldday_ajax.ajax_url+"?action=km_reset_password",s,function(s){"success"==s.status?(e("#km_forget_password")[0].reset(),t.DisplayMessage(a,"success",s.message)):t.DisplayMessage(a,"error",s.message),e(a).prop("disabled",!1)})})},inputincrement:function(){e(".minus:not(.disabled)").click(function(){var a=e(this).parent().find("input"),t=parseInt(a.val())-1;return t=t<0?0:t,a.val(t),a.change(),!1}),e(".plus:not(.disabled)").click(function(){var a=e(this).parent().find("input");return a.val(parseInt(a.val())+1),a.change(),!1})},checkoutpageevents:function(){e(".km_enable_cardoption").on("change",function(){t.CardInput(),t.paymentrequired=!0,e(".km_payment_wrap").removeClass("km_hidden"),e('.km_payment_option:not(".km_enable_cardoption")').prop("checked",!1),e("#_stripeToken").length||e(".km_purchase_form").prepend("<input type='hidden' name='stripeToken' value='' id='_stripeToken'>"),e(".km_payment_wrap").find("input:not(.optional), textarea:not(.optional), select:not(.optional)").attr("required",!0)}),e('.km_payment_option:not(".km_enable_cardoption")').on("change",function(){t.paymentrequired=!1,e(".km_enable_cardoption").prop("checked",!1),e(".km_payment_wrap").addClass("km_hidden"),e("#_stripeToken").remove(),e(".km_payment_wrap").find("input, textarea, select").removeAttr("required")}),e(document).on("click",".km_provider_terms_display",function(e){e.preventDefault(),t.makeCall(fieldday_ajax.ajax_url,{action:"km_getprovider_terms"},function(e){"success"==e.status?t.displaySecondModal(e,"modal-small"):t.DisplayAlert("error",e.message)})}),e(document).on("change",".km_provider_terms",function(){e(this).is(":checked")?e(".km_accepted_terms").prop("checked",!0):e(".km_accepted_terms").prop("checked",!1)}),e(document).on("click",".open_km_modal",function(){var a=e(this).data("target"),t=e(this).data("kid-id");e(a).find("input, select, textarea").each(function(){e(this).attr("data-kid-id",t)}),e(a).fadeIn()}),e(document).on("click change blur keyup",".km_kids_form_modal input, .km_kids_form_modal select, .km_kids_form_modal textarea",function(){var a=e(this).data("kid-id");e("#update_kid_info_"+a).val("true")}),e(document).on("click",".km_popup_close",function(a){a.preventDefault();var t=e(this).data("popup-id");e(t).fadeOut()}),e(document).on("click",".save_medical_forms",function(a){a.preventDefault();var s=!1,i=e(this).data("form-type"),r=e(this).data("kid-id"),n=i+"_"+r;if("kidsDoctors"==i||"kidsMedicalInsurances"==i||"kidsDentalInsurances"==i)e("#km_purchase_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:n}).done(function(){s=!0});else if("kidsHealthConcerns"==i||"kidsMedicationAllergies"==i||"kidsEnvironmentAllergies"==i||"kidsSymptoms"==i||"kidsTreatments"==i||"kidsDietRestricts"==i||"kidsFoodAllergies"==i){var o=e("#"+n).find('input[type="checkbox"]').length,d=e("#"+n).find('input[type="checkbox"]:checked').length;o>d&&d>0&&(s=!0)}if(s){e(this).parents(".km_modal").find(".km_modal_footer .med_form_error").remove(),e(this).parents(".km_modal").fadeOut();e('[data-target="#km_modal_'+i+"_"+r+'"]').length;e('[data-target="#km_modal_'+i+"_"+r+'"]').removeClass("Form_Error").addClass("Form_Success km_primary_border")}else{e('[data-target="#km_modal_'+i+"_"+r+'"]').removeClass("Form_Success km_primary_border").addClass("Form_Error"),e("#km_modal_"+n+" .km_modal_footer .med_form_error").remove();let a=e(this).parents(".km_modal").find(".med_form_error");e(this).parents(".km_modal").find(".med_form_error").css("display","none"),e(this).parents(".km_modal").find(".km_modal_footer").append(a.clone()),a.fadeOut(),setTimeout(function(){},3e3)}}),e(document).on("change",".km_noform",function(){e(this).is(":checked")?(e(this).parents(".km_modal_medfor_wrap").find(".km_hidden_noform_field").val(!0),e(this).parents(".km_medical_form_wrap").find('input[type="checkbox"]:not(.km_noform)').prop({checked:!1,disabled:!1}),e(this).parents(".km_medical_form_wrap").find(".km_checkbox_wrap:not(.km_noform_wrap)").addClass("disabled"),e(this).parents(".km_medical_form_wrap").find(".related_checkbox_fields .km_input").val(""),e(this).parents(".km_medical_form_wrap").find(".related_checkbox_fields").addClass("km_hidden"),e(this).parents(".km_modal_medfor_wrap").find(".km_hidden_noform_field").val(!0),e(this).parents(".km_medical_form_wrap").find(".km_hidden_noform_field").val(!0)):(e(this).parents(".km_modal_medfor_wrap").find(".km_hidden_noform_field").val(!1),e(this).parents(".km_medical_form_wrap").find(".km_hidden_noform_field").val(!1),e(this).parents(".km_medical_form_wrap").find('input[type="checkbox"]:not(.km_noform)').prop("disabled",!1),e(this).parents(".km_medical_form_wrap").find(".km_checkbox_wrap:not(.km_noform_wrap)").removeClass("disabled"))}),e(document).on("change",".kid-form-checkbox",function(a){1==e(this).prop("checked")?(e(this).parents(".km_medical_form_wrap").find(".km_noform").prop({checked:!1,disabled:!1}),e(this).parents(".km_medical_form_wrap").find(".km_checkbox_wrap:not(.km_noform_wrap)").removeClass("disabled"),e(this).parents(".km_modal_medfor_wrap").find(".km_hidden_noform_field").val(!1),e(this).parents(".km_medical_form_wrap").find(".km_hidden_noform_field").val(!1)):(e(this).parents(".km_modal_medfor_wrap").find(".km_hidden_noform_field").val(!0),e(this).parents(".km_medical_form_wrap").find(".km_hidden_noform_field").val(!0),e(this).parents(".km_medical_form_wrap").find('input[type="checkbox"]:not(.km_noform)').prop("disabled",!1),e(this).parents(".km_medical_form_wrap").find(".km_checkbox_wrap:not(.km_noform_wrap)").removeClass("disabled"))}),e(document).on("change",".km_enable_form",function(){e(this).is(":checked")?e(this).parents(".km_medical_form_wrap").find(".km_input:not(.optional)").prop({required:!0,disabled:!1}):e(this).parents(".km_medical_form_wrap").find(".km_input:not(.optional)").prop({required:!1,disabled:!0}).val(""),t.requiredfields()}),e(document).on("click",".apply_store_credit",function(){var a=e(this).data("credit-id");e("#manualStoreCreditPaid, #storeCreditId, #applySiblingDiscount").remove();var s=e(".manual_store_credit_paid:checked").val(),i=e(".manual_store_credit_paid:checked").data("credit-type");s&&"siblingDiscount"!==i&&e("#km_purchase_form").prepend('<input type="hidden" name="manualStoreCreditPaid" id="manualStoreCreditPaid" value="'+s+'"/>'),a&&"siblingDiscount"!==i&&e("#km_purchase_form").prepend('<input type="hidden" name="storeCreditId" id="storeCreditId" value="'+a+'"/>'),"siblingDiscount"==i&&e("#km_purchase_form").prepend('<input type="hidden" name="applySiblingDiscount" id="applySiblingDiscount" value="true"/>'),t.UpdateCart(),t.closepopup(),t.NextStep()}),e(document).on("click",".decline_store_credit",function(){e("#manualStoreCreditPaid, #storeCreditId, #applySiblingDiscount").remove(),t.UpdateCart(),t.closepopup(),t.NextStep()})},kidspageevents:function(){e(document).on("click",".km_add_kid_modal",function(){t.makeCall(fieldday_ajax.ajax_url,{action:"km_add_new_kid"},function(e){"success"==e.status?(t.displayModal(e,"modal-large modal_newkid"),t.requiredfields(),t.fielddaySelect()):"fail"==e.status&&t.DisplayAlert("error",e.message)})}),e(document).on("click",".km_update_insurance",function(a){var s=e(this);a.preventDefault(),e("#parent_insurance_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"parent_insurance_form"}).done(function(){var a=new FormData(e("#parent_insurance_form")[0]);s.prop("disabled",!0),t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_insurance",a,function(e){"success"==e.status?t.DisplayMessage(s,"success",e.message):"fail"==e.status&&t.DisplayMessage(s,"error",e.message),s.prop("disabled",!0)})})}),e(document).on("change",".km_hasextra_form",function(){e(this).is(":checked")?e(this).parents(".km_field_wrap").find(".related_checkbox_fields").removeClass("km_hidden"):(e(this).parents(".km_field_wrap").find(".related_checkbox_fields").addClass("km_hidden"),e(this).parents(".km_field_wrap").find(".km_input").val(""))}),e(document).on("click",".km_add_kid_save",function(a){a.preventDefault(),e("#km_form_kid_add").parsley(t.settings.parsley_valiation_options).whenValidate({group:"new_kid_create"}).done(function(){if(t.updateDate(e("#km_form_kid_add"))){var a=new FormData(e("#km_form_kid_add")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_save_kid",a,function(a){"success"==a.status?(t.closepopup(),t.DisplayAlert("success",a.message),e(".km_single_kid_main").append(a.html)):"fail"==a.status&&t.DisplayAlert("error",a.message)})}})}),e(document).on("click",".km_update_profile",function(a){a.preventDefault();var s=e(this);s.data("id");e("#km_kid_profile_update").parsley(t.settings.parsley_valiation_options).whenValidate({group:"update_kid"}).done(function(){if(t.updateDate(e("#km_kid_profile_update"))){var a=new FormData(e("#km_kid_profile_update")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_kid_profile",a,function(e){"success"==e.status?t.DisplayMessage(s,"success",e.message):"fail"==e.status&&t.DisplayMessage(s,"success",e.message)})}})}),e(document).on("click",".km_delete_kid",function(a){if(a.preventDefault(),confirm(fieldday_ajax.delteConfirm)){var s=e(this).data("kid-num-id");t.makeCall(fieldday_ajax.ajax_url,{action:"km_delete_kid",kidId:s},function(a){"success"==a.status?(e("#km_parent_kid_"+s).remove(),t.DisplayAlert("success",a.message)):t.DisplayAlert("error",a.message)})}}),e(document).on("click",".km_save_kidform",function(a){a.preventDefault();var s=e(this),i=jQuery(this).parents("form:first");i.parsley(t.settings.parsley_valiation_options).whenValidate({group:"kids_forms_field"}).done(function(){var e=new FormData(i[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_save_kidforms",e,function(e){"success"==e.status?t.DisplayMessage(s,"success",e.message):t.DisplayMessage(s,"error",e.message)})})})},calculateCartPrice:function(){},getParticipants:function(a,s){t.makeCall(fieldday_ajax.ajax_url,{action:"km_atc_partcipants",cartkey:a,sessionID:s},function(a){"success"==a.status?e(".km_atc_participants").html(a.content):t.DisplayAlert("error",a.message)})},proceed_event_ticket_book_step_one:function(){var a=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_events_price",a,function(a){"success"==a.status?(e(".km_events_prices_section").html(a.data),e(".km_event_ordersummary").html(a.summary),e(".km_required_disclaimer").html('* Indicate Required Field <span class="km_scroll_indicate">(Scroll to see price details)</span>'),e(".km_event_continue").removeClass("km_hidden")):(e(".km_events_prices_section").html(""),e(".km_event_ordersummary").html(""),a.datablank||e(".km_seats_error_message_event_tickets").text(a.message))})},atc_cart_steps:function(){e(document).mouseup(function(a){var t=e("#km_cart_items_wrap");e(a.target).parents("div").hasClass("km_cart_toggle")||t.is(a.target)||0!==t.has(a.target).length||(t.css({right:"-370px"}),jQuery("button.mobile_bttn").css({display:"block"}))}),e(document).on("click",".km_edit_cart_item",function(){let a=e(this).data("cart-key");t.makeCall(fieldday_ajax.ajax_url,{action:"km_edit_cart_item",cartkey:a},function(a){"success"==a.status?(t.displayModal(a,"modal-large km_addtocart_modal"),e(".km_modal_heading").hide(),t.requiredfields(),t.cartOnScroll(),t.BookingSelection(),t.BookingCalander(),t.MultiWeekBookingCalander(),t.fielddaySessionTime(),e(".km_profile_participants li.km_active_participant").addClass("km_primary_border km_primary_shadow")):t.DisplayAlert("error",a.message)})}),jQuery(document).on("change",".km_dob_wrap .km_date_day, .km_dob_wrap .km_date_month, .km_dob_wrap .km_date_year",function(){const e=jQuery(this).closest("form");let a=e.attr("id");e&&""!=a&&fieldday.updateDate(jQuery("#"+a))}),e(document).on("change",".km_eparticipants_type , .km_event_radio",function(){clearTimeout(a);a=setTimeout(()=>{t.proceed_event_ticket_book_step_one()},200)}),e(document).on("click",".km_addmi_options_input-number-increment",function(){let s=e(this).parents(".km_addmi_options_input-number-group").find(".km_addmi_options_input-number"),i=s.attr("min"),r=(s.attr("max"),parseInt(s.val(),10));if((""==r||isNaN(r))&&(r=0),r+1<i)return!1;s.val(r+1),s.attr("value",s.val());clearTimeout(a),a=setTimeout(()=>{t.proceed_event_ticket_book_step_one()},200)}),e(document).on("click",".km_addmi_options_input-number-decrement",function(){let s=e(this).parents(".km_addmi_options_input-number-group").find(".km_addmi_options_input-number"),i=s.attr("min"),r=(s.attr("max"),parseInt(s.val(),10));if((""==r||isNaN(r))&&(r=0),r-1<i)return!1;s.val(r-1),s.attr("value",s.val());clearTimeout(a),a=setTimeout(()=>{t.proceed_event_ticket_book_step_one()},200)}),e(document).on("input change copy",".km_addmi_options_input-number",function(){let s=e(this),i=s.prop("min"),r=(s.prop("max"),parseFloat(s.val())||0);(""==r||isNaN(r))&&(r=0),r<i&&s.val(i),s.val(function(e,a){return a.replace(/[^\d]/g,"")});clearTimeout(a),a=setTimeout(()=>{t.proceed_event_ticket_book_step_one()},200)}),e(document).on("click",".km_eventpromo_coupon_remove",function(){e("input[name=eventpromocode]").length&&(e("input[name=eventpromocode]").val(""),e(".km_eventpromo_btn").trigger("click"))}),e(document).on("click",".km_eventpromo_btn",function(){var a=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_events_price",a,function(a){"success"==a.status?(e(".km_events_prices_section").html(a.data),e(".km_event_ordersummary").html(a.summary),0===a.isPrice?(e("#km_add_to_cart_form").find(".kmeventPrice").text(""),e(".km_package_card input, .km_package_card select").removeAttr("required"),e(".km_event_checkout").removeClass("km_hidden"),e(".km_event_continue").addClass("km_hidden")):(e(".km_package_card input, .km_package_card select").attr("required","required"),e(".km_event_checkout").addClass("km_hidden")),1===a.isPrice?(e(".km_package_card").addClass("km_hidden"),e(".km_package_card input, .km_package_card select").removeAttr("required"),e("#km_add_to_cart_form").find(".kmeventPrice").text("")):(e(".km_package_card").removeClass("km_hidden"),e(".km_package_card input, .km_package_card select").attr("required","required")),a.if_discount_applied&&t.DisplayAlert("success","Coupon Applied Successfully.")):(e("input[name=eventpromocode]").val(""),t.DisplayAlert("error",a.message))})}),e(document).on("click",".km_event_continue",function(){let a=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_events_price",a,function(a){if("success"==a.status?(e(".km_events_prices_section").html(a.data),e(".km_event_ordersummary").html(a.summary),0===a.isPrice?(e("#km_add_to_cart_form").find(".kmeventPrice").text(""),e(".km_package_card input, .km_package_card select").removeAttr("required"),e(".km_event_checkout").removeClass("km_hidden"),e(".km_event_continue").addClass("km_hidden"),e(".km_events_right .km_freevent").length||e(".km_events_right").append('<span class="km_freevent km_notloggedIn">Enjoy Free Event, Fill the details above and click on checkout button to confirm the Booking.</span>')):(e(".km_event_checkout").addClass("km_hidden"),e(".km_package_card input, .km_package_card select").attr("required","required"),e(".km_event_continue").addClass("km_hidden"),e(".km_events_right .km_freevent").remove()),1===a.isPrice?(e(".km_package_card").addClass("km_hidden"),e(".km_package_card input, .km_package_card select").removeAttr("required"),e("#km_add_to_cart_form").find(".kmeventPrice").text(""),e(".km_events_right .km_freevent").length||e(".km_events_right").append('<span class="km_freevent">Enjoy Free Event, Please click on checkout button to confirm the Booking.</span>')):(e(".km_package_card input, .km_package_card select").attr("required","required"),e(".km_package_card").removeClass("km_hidden"),e(".km_events_right .km_freevent").remove())):e("input[name=eventpromocode]").val(""),e(".km_events_prices_section").is(":empty"))return""!=a.message?e(".kmeventrequired").text(a.message):e(".kmeventrequired").text("Please select the number of seats to continue."),e(".km_modal_content").animate({scrollTop:0},"fast"),!1;setTimeout(function(){e(".km_event_continue").addClass("km_hidden")},50),e(".kmeventrequired").text(""),e(".km_cart_options").addClass("km_hidden"),e(".km_event_credit,.km_event_ordersummary").removeClass("km_hidden"),e(".km_event_checkout,.km_event_back").removeClass("km_hidden"),e(".km_modal_content").animate({scrollTop:0},"fast"),t.requiredfields(),t.CardInput()})}),e(document).on("click",".km_event_back",function(){e(".km_cart_options").removeClass("km_hidden"),setTimeout(function(){e(".km_event_continue").removeClass("km_hidden")},50),e(".km_event_credit,.km_event_ordersummary").addClass("km_hidden"),e(".km_event_checkout,.km_event_back").addClass("km_hidden")}),e(document).on("click",".km_multiweek_continue",function(){if(e(".km_profile_participants").length){if(0==e("#km_atc_participant_count").val())return e(".kmkidsrequired").text("Please select Participant"),t.scrollInModal(".km_modal_content",".km_multiweek_options"),!1;e(".kmkidsrequired").text("")}if(e(".km_event_Daysweek").length){if(!e(".km_multiweekday_selection").is(":checked"))return e(".kmdaysrequired").text("Please select Days"),t.scrollInModal(".km_modal_content",".km_booking_selection"),!1;e(".kmdaysrequired").text("")}if(e(".km_multiweek_calander").length){if(""===e("#StartingDate").val())return e(".kmdaterequired").text("Please select Date"),t.scrollInModal(".km_modal_content",".km_booking_selection"),!1;e(".kmdaterequired").text("")}e(".km_multiweek_options").addClass("km_hidden"),e(".km_multiweek_continue").addClass("km_hidden"),e(".km_multiweek_credit").removeClass("km_hidden"),e(".km_multiweek_btn,.km_multiweek_back").removeClass("km_hidden"),e(".km_modal_content").animate({scrollTop:0},"fast"),t.requiredfields(),t.CardInput()}),e(document).on("click",".km_multiweek_back",function(){e(".km_multiweek_options").removeClass("km_hidden"),e(".km_multiweek_continue").removeClass("km_hidden"),e(".km_multiweek_credit").addClass("km_hidden"),e(".km_multiweek_btn,.km_multiweek_back").addClass("km_hidden")}),e(document).on("click",".km_more_summary",function(){e(".km_event_orderdetails").toggleClass("km_hidden"),e(".km_event_orderdetails").toggleClass("open")}),e(document).on("click",".km_ticketinclude",function(){e(this).next(".km_event-notes").slideToggle("slow")}),e(document).on("click",".km_guest_participants li",function(){e(".km_guest_participants li").removeClass("km_active_participant km_primary_border km_primary_shadow"),e(this).addClass("km_active_participant km_primary_border km_primary_shadow");let a=e(this).data("count");e("#km_atc_participant_count").val(a);var s=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_kid_form",s,function(s){e(".km_guestparticipant_forms").html(s.content),s.purchasecount&&e(".km_package_purchase_btn").attr("data-purchasecount",s.purchasecount),t.requiredfields(),1==a?e(".km_delete_participant").addClass("disabled"):e(".km_delete_participant").removeClass("disabled")})}),e(document).on("click",".add_new_participant",function(a){a.preventDefault();var s=e("#km_atc_participant_count").val(),i=parseInt(s)+1;e("#km_atc_participant_count").val(i);var r=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_add_new_kid",r,function(a){e(".km_addnewparticipant_forms").html(a.content),t.requiredfields(),t.fielddaySelect()})}),e(document).on("click",".km_add_participant",function(a){event.preventDefault();let s=e("#km_atc_cartkey").val();var i=e(this).parents("form").attr("id"),r=e(this).parents("form").find("#km_atc_session_id").val();e("#"+i).parsley(t.settings.parsley_valiation_options).whenValidate({group:"new_kid_create"}).done(function(){if(t.updateDate(e("#"+i))){var a=new FormData(e("#"+i)[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_save_kid",a,function(a){"success"==a.status?(e(".km_addnewparticipant_forms").html(""),e(".modal_newkid").length&&(e(".modal_newkid").hide(),location.reload()),t.getParticipants(s,r)):"fail"==a.status&&t.DisplayAlert("error",a.message)})}})}),e(document).on("click",".km_add_participant_cancel",function(a){a.preventDefault(),e(".km_addnewparticipant_forms").html(""),e(".km_col_10_my_account").length&&t.closepopup()}),e(document).on("click",".km_package_next_btn",function(){e(this).parents("div").find("form").find(".package_payment_section").show(),e(this).parents("div").find("form").find(".km_package_payment_screen_info,.km_no_payment_info").toggleClass("km_hidden"),e(this).parents("div").find("form").find(".km_atc_participants,.recommendedclassPackages, .km_about_package, .km_renewal").hide(),e(this).parents("div").find(".km_modal_footer").find(".km_package_next_btn").hide(),e(this).parents("div").find(".km_modal_footer").find(".km_package_purchase_btn,.km_package_back_btn").show();var a=e(".km_purchasefield:checked").parents(".km_radio_wrap").find(".km_radio_text").clone();e(".km_package_sel").html(a)}),e(document).on("click",".km_package_back_btn",function(){e(this).parents("div").find("form").find(".package_payment_section").hide(),e(this).parents("div").find("form").find(".km_package_payment_screen_info,.km_no_payment_info").toggleClass("km_hidden"),e(this).parents("div").find("form").find(".km_atc_participants,.recommendedclassPackages, .km_about_package ,.km_renewal").show(),e(this).parents("div").find(".km_modal_footer").find(".km_package_next_btn").show(),e(this).parents("div").find(".km_modal_footer").find(".km_package_purchase_btn,.km_package_back_btn").hide()}),e(document).on("change",".km_purchasefield",function(){var a=e(this).parents(".km_radio_wrap").find(".km_radio_text").clone();e(".km_package_sel").html(a)}),e(document).on("change",".km_multiweekday_selection",function(){e(this).is(":checked")?e(this).parent("label").addClass("km_primary_bg"):e(this).parent("label").removeClass("km_primary_bg");new FormData(e("#km_add_to_cart_form")[0]);t.MultiweekExtradata()}),e(document).on("click",".km_profile_participants li:not(.add_new_participant)",function(){e(this).find(".selected_kid").prop("checked")?(e(this).removeClass("km_active_participant km_primary_border km_primary_shadow"),e(this).find(".km_profile_participant_form input").attr("readonly",!0),e(this).find(".km_profile_participant_form input").attr("disabled",!0),e(this).find(".selected_kid").prop("checked",!1)):(e(this).addClass("km_active_participant km_primary_border km_primary_shadow"),e(this).find(".selected_kid").prop("checked",!0),e(this).find(".km_profile_participant_form input").attr("readonly",!1),e(this).find(".km_profile_participant_form input").attr("disabled",!1)),e("#km_atc_participant_count").val(e(".km_active_participant").length),e(".km_selected_kids .km_kids").html(""),e(".km_active_participant").each(function(){var a=e(this).find(".km_participant_name").clone();e(".km_selected_kids .km_kids").append(a)});var a=e(this).parents("div").find("form"),s=e(this).parents("div").find("form").find(".package_id"),i=e(this).parents("div").find("form").find("#km_atc_participant_count").val();if(0==e("#km_atc_participant_count").val()?e(".kmkidsrequired").text("Please select Participant"):e(".kmkidsrequired").text(""),e(s).length){var r=new FormData(a[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_get_class_packages_options",r,function(e){if("success"==e.status){jQuery(".km_renewal").html(e.renewal);var a=e.renewal_fre,t=0;jQuery(".km_package_next_btn,.km_package_purchase_btn").hide();var s=d=_=0,r=(s=e.data.data).packagePurchased,n=(s.paymentRequired,s.oneTimeFee,s.vendorPackage&&s.vendorPackage.price?[s.vendorPackage.price]:[]);if(0===n.length)var o=0;else{var d=n[0],_=n[0].additionalSeatCost;jQuery.each(d,function(e,a){t+=1});var l=t-1;if(i in d)o=n[0][i];else{var m=n[0][l];o=(i-l)*_+m}}if(1==i&&0==r){var c=[{option:"package",timeperiod:a,title:"Class Package",price:"$"+o.toFixed(2),checked:"checked"}];jQuery(".km_package_next_btn").show()}if(1==i&&1==r){c=[{option:"package",timeperiod:"",title:"Upgrade Class Package",price:"$"+o.toFixed(2),checked:"checked"}];jQuery(".km_package_next_btn").show()}if(i>1&&1==r){c=[{option:"package",timeperiod:a,title:"Upgrade Class Package",price:"$"+(o=o-m).toFixed(2),checked:"checked"}];jQuery(".km_package_next_btn").show()}if(i>1&&0==r){c=[{option:"package",timeperiod:a,title:"Class Package",price:"$"+o.toFixed(2),checked:"checked"}];jQuery(".km_package_next_btn").show()}for(var p of(jQuery(".recommendedclassPackages").html(""),jQuery(".recommendedclassPackages").html('<h3 class="km_heading_wrap  ">How would you like to pay?</h3>'),c)){var u="";if(p.price)u="<p>Price: "+p.price+" "+p.timeperiod+"</p>";jQuery(".recommendedclassPackages").append('<label class="km_radio_wrap"><div class="km_radio_text"><span>'+p.title+"</span>"+u+"</div><input "+p.checked+' data-price="'+p.price+'" id="'+p.option+'" data-parsley-group="atc_field" class="km_purchasefield" data-text="" value="'+p.option+'" type="radio" name="ATC[prices]"><span class="km_radio"></span></label>')}}})}if(e(".km_multiweek_section").hasClass("km_multiweek_session")){r=new FormData(a[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_multiweek_calculations",r,function(a){if("success"==a.status){var t=moment(a.data.nextPaymentOn).format("MMM Do, YYYY");e(".km_due_today .km_date_value").text("$"+a.data.totalAmount);var s="$"+a.data.payableAmount;if(a.data.totalAmount!=a.data.payableAmount)s="<strike>$"+a.data.totalAmount+"</strike>$"+a.data.payableAmount;e(".km_total_due .km_date_value").html(s),e(".km_next_payment .km_date_value").text(t),e(".km_weeks_remaining .km_date_title").text(a.data.remainingWeeks+" Weeks Remaining"),e(".km_weeks_remaining .km_date_value").text(a.data.session.paymentFrequency+" - $"+a.data.nextPaymentAmount+"/seat"),e(".km_due").removeClass("km_hidden");var i=moment(a.data.nextBookingDate).format("MMM Do, YYYY");e(".km_joiningdate .km_date_value").html("<b>"+i+"</b>"),e(".km_joiningdate").show(),""!=a.data.autoRenewalRequired&&e(".km_renewal").removeClass("km_hidden"),a.data.payableAmount?e(".paymentMethod").val("card"):e(".paymentMethod").val("free")}})}}),e(document).on("click",".km_update_cart",function(a){if(a.preventDefault(),e(".km_participant_error").remove(),void 0!==e(".km_allowed_seats").attr("data-static-seats"))var s=e(".km_allowed_seats").attr("data-static-seats");else s=e(".km_allowed_seats").attr("id");var i=e('input[name="kidscount"]').val();if(parseInt(i)>parseInt(s))return e(".km_package_participants .km_heading_title").after('<span class="km_participant_error">Sadly, we can only accommodate '+s+" attendees.</span>"),t.scrollInModal(".km_modal_content",".km_package_participants"),!1;e("#km_add_to_cart_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"atc_field"}).done(function(){var a=e(this).attr("href");t.updateDate(e("#km_add_to_cart_form"))&&t.updateSessionToCart(a)})}),e(document).on("click",".km_delete_participant",function(){let a=e("#km_atc_participant_count").val();if(a>1){e(this).parents(".km_single_kid_wrap").remove();let t=a-1;1==t?e(".km_delete_participant").addClass("disabled"):e(".km_delete_participant").removeClass("disabled"),e("#km_atc_participant_count").val(t),e(".km_guest_participants li").removeClass("km_active_participant  km_primary_border km_primary_shadow"),e(".km_guest_participants li[data-count='"+t+"']").addClass("km_active_participant km_primary_border km_primary_shadow");let s=1;e(".km_single_kid_wrap").each(function(){let a=e(this).data("participant-text");e(this).find(".km_kidform_header h3").html(a+" "+s),s++})}}),e(document).on("click",".km_add_to_cart",function(a){e(".km_participant_error").remove();var s=e(this).data("checkout-rediect");if(void 0!==e(".km_allowed_seats").attr("data-static-seats"))var i=e(".km_allowed_seats").attr("data-static-seats");else i=e(".km_allowed_seats").attr("id");var r=e('input[name="kidscount"]').val();if(parseInt(r)>parseInt(i))return e(".km_package_participants .km_heading_title").after('<span class="km_participant_error">Sadly, we can only accommodate '+i+" attendees.</span>"),t.scrollInModal(".km_modal_content",".km_package_participants"),!1;if(e(".km_guest_personalinfo").length)var n="atc_infofield";else n="atc_field";a.preventDefault(),e("#km_add_to_cart_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:n}).done(function(){var a=e(this).attr("href");t.updateDate(e("#km_add_to_cart_form"))&&"undefined"!=s&&t.addSessionToCart(a,s)})}),e(document).on("click",".km_add_to_waitlist",function(a){e(".km_participant_error").remove();e('input[name="kidscount"]').val();a.preventDefault(),e("#km_add_to_cart_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"atc_field"}).done(function(){t.updateDate(e("#km_add_to_cart_form"));t.addSessionToWaitlist()})}),e(document).on("click",".km_cartguest_continue",function(a){if(a.preventDefault(),e(".km_participant_error").remove(),void 0!==e(".km_allowed_seats").attr("data-static-seats"))var s=e(".km_allowed_seats").attr("data-static-seats");else s=e(".km_allowed_seats").attr("id");var i=e('input[name="kidscount"]').val();if(parseInt(i)>parseInt(s))return e(".km_package_participants .km_heading_title").after('<span class="km_participant_error">Sadly, we can only accommodate '+s+" attendees.</span>"),t.scrollInModal(".km_modal_content",".km_package_participants"),!1;e("#km_add_to_cart_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"atc_field"}).done(function(){t.updateDate(e("#km_add_to_cart_form"))&&(e(".km_cart_sectionone").addClass("km_hidden"),e(".km_guest_personalinfo").removeClass("km_hidden"),e(".km_add_to_cart,.km_cartguest_back").css("display","inline-block"),e(".km_cartguest_continue").css("display","none"))})}),e(document).on("click",".km_cartguest_back",function(a){e(".km_cart_sectionone").removeClass("km_hidden"),e(".km_guest_personalinfo").addClass("km_hidden"),e(".km_cartguest_continue").css("display","inline-block"),e(".km_add_to_cart,.km_cartguest_back").css("display","none")}),e(document).on("click",".km_add_to_cart_membership",function(a){a.preventDefault();var s={membershipid:e(this).data("membershipid"),membershipprice:e(this).data("membership-price"),providerId:e(this).data("providerid"),title:e(this).data("membership-title"),action:"km_set_membershipcartitems"};t.makeCall(fieldday_ajax.ajax_url,s,function(e){"success"==e.status&&(t.displayModal(e,"modal-normal"),t.CardInput())})}),e(document).on("click",".km_package_purchase_btn",function(a){a.preventDefault();var s=e(this).parents("div").find("form"),i=e(this).parents(".km_modal_alert").find("form").find(".km_package_cardId:checked").val();console.log(i),a.preventDefault(),e(s).parsley(t.settings.parsley_valiation_options).whenValidate({group:"merchandise_field"}).done(function(){if(i){var a=new FormData(s[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_packagepurchase",a,function(e){"success"==e.status?(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_package_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)})}else t.StripeProcess(s,function(a){if(a.error)t.DisplayAlert("error",a.error.message),t.kmRemoveLoader();else{s.find(".stripe_token").val(a.id);var i=new FormData(s[0]),r=a.id;e(this).parents("div").find("form").find(".stripe_token").val(r),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_packagepurchase",i,function(e){"success"==e.status?(console.log(e.status),s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_package_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)})}})})}),e(document).on("click",".km_self_checkIn_btn",function(a){a.preventDefault();var s=e(this).attr("data-id"),i=e(this).attr("data-order"),r=new FormData;r.set("ticketid",s),r.set("orderno",i),t.postFormData(fieldday_ajax.ajax_url+"?action=km_self_checkin",r,function(a){"success"==a.status?e(".km_checkIn").html(a.content):t.DisplayAlert("error",a.message)})}),e(document).on("click",".km_pullticket_btn",function(a){var s=e("input[name=ticket_email]").val(),i=e("input[name=ticket_phone]").val();if(""==s&&""==i)return e(".invalid-form-error-message").html("Must fill one field either email id or phone number").addClass("filled"),!1;var r=e("#km_ticket_form");r.parsley().validate();var n=new FormData(r[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_pullticket",n,function(a){"success"==a.status?e(".km_checkIn").html(a.content):t.DisplayAlert("error",a.message),t.fielddaySessionTime(),t.PhoneInput(),t.scrollTo(".km_checkIn")})}),e(document).on("click","#contact-submit",function(a){a.preventDefault();var s=e(this).parents("form"),i=new FormData(s[0]);e(this).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"km_contact"}).done(function(){t.postFormData(fieldday_ajax.ajax_url+"?action=km_contact_form",i,function(a){"success"==a.status?(e(".km_contact_message").html("<p>"+a.message+"</p>"),e(s)[0].reset()):t.DisplayAlert("error",a.message)})})}),e(document).on("click","#km_order_refund_form_submit",function(a){a.preventDefault();var s=e(this).parents("form"),i=new FormData(s[0]);let r=e('input[name="order_refund"]:checked').val();r?t.postFormData(fieldday_ajax.ajax_url+"?action=refundFormEventSession",i,function(e){"success"==e.status?(t.DisplayAlert("success",e.message),"refund"==r?jQuery(".km_checkin_tickets_option_content").html("<h5 class='km_checkin_tickets_option_content_h5'>Cancellation Request Submitted!</h5><p class='km_checkin_tickets_option_content_p_cls'>We have successfully submitted your cancellation request. You will receive an email once it is processed. The refund amount will be credited to your bank account within 5 - 10 business days.</p>"):setTimeout(function(){location.reload()},1500)):t.DisplayAlert("error",e.message)},"","km_order_refund_form_submit"):t.DisplayAlert("error","Please select Ticket Options First.")}),e(document).on("click","#demo-submit",function(a){a.preventDefault();var s=e(this).parents("form"),i=new FormData(s[0]);e(this).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"km_contact"}).done(function(){t.postFormData(fieldday_ajax.ajax_url+"?action=km_requestdemo_form",i,function(a){"success"==a.status?(e(".km_contact_message").html("<p>"+a.message+"</p>"),e(s)[0].reset()):t.DisplayAlert("error",a.message)})})}),e(document).on("click",".km_sticky_btn",function(e){e.preventDefault();var a=new FormData;t.postFormData(fieldday_ajax.ajax_url+"?action=km_sticky_widget",a,function(e){"success"==e.status?(t.displayModal(e,"modal-medium km_sticky_modal km_sticky_widget_pop_up"),t.PhoneInput(),t.requiredfields(),d=grecaptcha.render("c-recaptch",{sitekey:fieldday_ajax.g_sitekey})):t.DisplayAlert("error",e.message)})}),e(document).on("click","#partyform-submit",function(a){a.preventDefault();var s=e(this).parents("form"),i=new FormData(s[0]);e(this).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"km_party"}).done(function(){t.postFormData(fieldday_ajax.ajax_url+"?action=km_party_form",i,function(a){"success"==a.status?(e(".km_success_message").html("<p>"+a.message+"</p>"),e(s)[0].reset()):t.DisplayAlert("error",a.message)})})}),e(document).on("click",".km_sticky_icon",function(a){a.preventDefault(),e(".km_sticky_content").toggleClass("km_hidden_sticky"),e(".km_sticky_content").hasClass("km_hidden_sticky")?(e(".km_sticky_icon").addClass("km_sticky_open"),e(".km_sticky_icon").removeClass("km_sticky_close"),t.setCookie("km_stickyform","close")):(e(".km_sticky_icon").addClass("km_sticky_close"),e(".km_sticky_icon").removeClass("km_sticky_open"),t.setCookie("km_stickyform","open"))}),e(document).on("click",".KmStickyWidgetAddToCartIcon",function(a){a.preventDefault(),0===e("#km_cart_items_wrap").length&&e('<div id="km_cart_items_wrap"></div>').appendTo("body"),t.updatefielddayCart(e("[id=km_cart_items_wrap]"))}),e(document).on("click",".km_event_checkout",function(a){a.preventDefault();var s=e(this).parents("div").find("form");if(e(this).parents(".km_modal_alert").find("form").find(".km_package_cardId:checked").val()){var i=new FormData(s[0]);t.km_loader(),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_eventpurchase",i,function(e){"success"==e.status?""!=e.redirect?window.location.href=e.redirect:(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_event_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)},"","km_event_checkout_btn")}else{if(1==e(this).parents("div").find("form").find(".kmeventPrice").text())e(this).parents("div").find("form").parsley(t.settings.parsley_valiation_options_register).whenValidate({group:"event_fields"}).done(function(){t.StripeProcess(s,function(a){if(a.error)t.DisplayAlert("error",a.error.message),t.km_btn_RemoveLoader("km_event_checkout_btn"),t.kmRemoveLoader();else{s.find(".stripe_token").val(a.id);var i=new FormData(s[0]);i.set("hideloader","hide");var r=a.id;e(this).parents("div").find("form").find(".stripe_token").val(r),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_eventpurchase",i,function(a){"success"==a.status?""!=a.redirect?window.location.href=a.redirect:(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_event_modal").find(".km_modal_footer").hide(),e("#km_session_filter_form").length&&t.processSessionFilters()):t.DisplayAlert("error",a.message)},"","km_event_checkout_btn")}},!0,"km_event_checkout_btn")});else{i=new FormData(s[0]);e(this).parents("div").find("form").parsley(t.settings.parsley_valiation_options_register).whenValidate({group:"event_fields"}).done(function(){t.km_loader(),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_eventpurchase",i,function(a){"success"==a.status?""!=a.redirect?window.location.href=a.redirect:(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_event_modal").find(".km_modal_footer").hide(),e("#km_session_filter_form").length&&t.processSessionFilters()):t.DisplayAlert("error",a.message)},"","km_event_checkout_btn")})}}}),e(document).on("click",".km_multiweek_btn",function(a){a.preventDefault();var s=e(this).parents("div").find("form"),i=e(this).parents(".km_modal_alert").find("form").find(".km_package_cardId:checked").val(),r=new FormData(s[0]);i?(t.km_loader(),t.postFormData(fieldday_ajax.ajax_url+"?action=km_multiweekpurchase",r,function(e){"success"==e.status?e.redirect&&""!=e.redirect?window.location.href=e.redirect:(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_addtocart_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)},"","km_multiweek_purchase_btn_pc")):e(this).parents("div").find("form").parsley(t.settings.parsley_valiation_options_register).whenValidate({group:"multiweek_fields"}).done(function(){t.StripeProcess(s,function(a){if(a.error)t.DisplayAlert("error",a.error.message),t.km_btn_RemoveLoader("km_multiweek_purchase_btn_pc"),t.kmRemoveLoader();else{s.find(".stripe_token").val(a.id);var i=new FormData(s[0]),r=a.id;e(this).parents("div").find("form").find(".stripe_token").val(r),t.postFormData(fieldday_ajax.ajax_url+"?action=km_multiweekpurchase",i,function(e){"success"==e.status?e.redirect&&""!=e.redirect?window.location.href=e.redirect:(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_addtocart_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)},"","km_multiweek_purchase_btn_pc")}},!0,"km_multiweek_purchase_btn_pc")})}),e(document).on("click",".membership_purchase_button",function(a){a.preventDefault();var s,i=e(this).data("membershipid"),r=e(this).data("paymentmethod"),n=e(this).data("purchasecount"),o=e(this).find(".savecardcheck:checked").val(),d=e(this).parents("div").find("form");t.StripeProcess(d,function(e){if(e.error)t.DisplayAlert("error",e.error.message),t.kmRemoveLoader();else{d.find(".stripe_token").val(e.id);var a=new FormData(d[0]);s=e.id,a.set("membershipid",i),a.set("paymentmethod",r),a.set("purchasecount",n),a.set("stripeToken",s),a.set("saveCard",o),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_membershipurchase",a,function(e){if("success"==e.status)if(t.DisplayAlert("success",e.message),"localhost"==window.location.hostname){var a=window.location,s=a.protocol+"//"+a.host+"/"+a.pathname.split("/")[1];window.location=s+"/my-account/"}else window.location=window.location.origin+"/my-account/"})}})}),e(document).on("click",".km_add_to_cart_giftCard",function(a){a.preventDefault();var s=e("[name='recipientname']").val(),i=e("[name='recipient_email']").val();i=i.trim();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))return e(".km-gift-recipentent-email-error").show(),e("[name='recipient_email']").focus(),!1;e(".km-gift-recipentent-email-error").hide();var r=parseInt(e("input#km_gift_custom_amount").attr("max")),n=(parseInt(e("input#km_gift_custom_amount").attr("min")),parseInt(e("input#km_gift_custom_amount").val())),o=e("[name='sender_name']").val(),d=e("[name='usergiftmsg']").val(),_=e("span.km_sendoption_value.selectedCartItem").text();if(!e('input[name="km_gift_custom_amount"]').val())return t.DisplayAlert("error","Please select/enter the giftcard amount"),!1;if(""==s||""==o||""==d||""==i)return t.DisplayAlert("error","Please fill the requried fields."),!1;if(n>r)return t.DisplayAlert("error","Amount is over the $2000 maximum"),!1;var l=e(".km_single_giftcard .km_gift_image").data("giftcardid"),m=e(".km_single_giftcard .km_gift_image").attr("data-original"),c=e(".km_single_giftcard .km_gift_image").attr("src"),p=e(".giftcardprice").text(),u=e(".km_giftcard_title_single").text(),k=e("[name='parent_phone_gift_code']").val()+e("[name='parent_phone_gift_org_number']").val(),f=e("[name='send_date']").val(),h={giftCardid:l,image:m,imagethumb:c,amount:(p=e(".giftcardprice").text()).trim(),title:u.trim(),sendmethod:_,recipientname:s,recipientemail:i,recipientphone:k,usergiftmsg:d,sendername:o,senddate:f,action:"km_set_giftCardmodel"};localStorage.setItem("kmGiftCardPurchaseData_title",u.trim()),localStorage.setItem("kmGiftCardPurchaseData_sendmethod",_),localStorage.setItem("kmGiftCardPurchaseData_recipientname",s),localStorage.setItem("kmGiftCardPurchaseData_recipientemail",i),localStorage.setItem("kmGiftCardPurchaseData_amount",p),localStorage.setItem("kmGiftCardPurchaseData_recipientphone_code",e("[name='parent_phone_gift_code']").val()),localStorage.setItem("kmGiftCardPurchaseData_r_phone_org_no",e("[name='parent_phone_gift_org_number']").val()),localStorage.setItem("kmGiftCardPurchaseData_recipientphone",k),localStorage.setItem("kmGiftCardPurchaseData_usergiftmsg",d),localStorage.setItem("kmGiftCardPurchaseData_sendername",o),t.makeCall(fieldday_ajax.ajax_url,h,function(e){"success"==e.status&&(t.displayModal(e,"modal-large"),t.CardInput(),t.PhoneInput(),t.requiredfields())})}),e(document).on("click",".giftcard_purchase_button",function(a){a.preventDefault();var s,i,r,n=e(this).attr("data-giftcardid"),o=e(this).data("paymentmethod"),d=e(this).data("purchasecount"),_=e(".km_gift_image").text(),l=e(".km_gift_imagethumb").text(),m=e(".sendername").text(),c=e(".km_gift_amount ").text();s=e(".km_gift_loginusername").text(),senderName=e(".km_gift_username").text(),senderEmail=e(".km_gift_useremail").text(),senderPhone=e("[name='recipient_phone']").val(),massgage=e("span.km_gift_msg.purchase_model p").text(),i=e("[name='parent[email]']").val(),r=e("[name='parent[phone]']").val(),guest=e("input#usreguest").val(),null==i&&null==r&&(s=e("[name='userDetails[name]']").val(),i=e("[name='userDetails[email]']").val(),r=e("input#parent_phone").val());e(".savecardcheck:checked").val();var p={};p.number=e("#km_card_number").val(),p.cvc=e("#km_card_cvc").val(),p.exp_month=e("#expireMM").val(),p.exp_year=e(".km_card_expiry_year").val();var u=e(this).parents("div").find("form");e(u).parsley(t.settings.parsley_valiation_options).whenValidate({group:"merchandise_field"}).done(function(){t.StripeProcess(u,function(e){if(e.error)t.DisplayAlert("error",e.error.message),t.km_btn_RemoveLoader("km_gift_card_prchase_btn"),t.kmRemoveLoader();else{t.km_loader(),u.find(".stripe_token").val(e.id);var a=new FormData(u[0]);a.set("userName",s),a.set("userEmail",i),a.set("userPhone",r),a.set("giftCardid",n),a.set("paymentmethod",o),a.set("purchasecount",d),a.set("giftCardImage",_),a.set("giftCardImagethumb",l),a.set("amount",c),a.set("massgage",massgage),a.set("stripeToken",e.id),a.set("sendername",senderName),a.set("senderemail",senderEmail),a.set("senderphone",senderPhone),a.set("senderDisplayName",m),a.set("guest",guest),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_giftcardPurchase",a,function(e){"success"==e.status?(t.DisplayAlert("success","Thankyou for gift card purchase.Please check your Email address."),localStorage.setItem("kmGiftCardPurchaseData_title",""),localStorage.setItem("kmGiftCardPurchaseData_sendmethod",""),localStorage.setItem("kmGiftCardPurchaseData_recipientname",""),localStorage.setItem("kmGiftCardPurchaseData_recipientemail",""),localStorage.setItem("kmGiftCardPurchaseData_amount",""),localStorage.setItem("kmGiftCardPurchaseData_recipientphone_code",""),localStorage.setItem("kmGiftCardPurchaseData_r_phone_org_no",""),localStorage.setItem("kmGiftCardPurchaseData_recipientphone",""),localStorage.setItem("kmGiftCardPurchaseData_usergiftmsg",""),localStorage.setItem("kmGiftCardPurchaseData_sendername",""),setTimeout(function(){"localhost"==window.location.hostname?window.location=window.location.origin+"/wordpresss/my-account/":window.location=window.location.origin+"/my-account/"},1e3)):(t.DisplayAlert("error","Something went wrong.Please try again later."),setTimeout(function(){window.location=window.location.origin+"/my-account/"},1e3))},!0,"km_gift_card_prchase_btn")}},!0,"km_gift_card_prchase_btn")})}),e(document).on("click","#km_giftpurchase_btn",function(a){a.preventDefault();e(this).data("giftcardid");var s=e(this).data("title"),i={giftcardid:e(this).data("giftcardid"),giftcardtitle:s,giftcardpricerange:e(this).data("giftcardprice-range"),buttontext:e(this).text(),action:"km_set_singlegiftcard"};t.makeCall(fieldday_ajax.ajax_url,i,function(a){"success"==a.status&&(t.displayModal(a,"modal-large km_single_giftcardpopup"),t.requiredfields(),fieldday.setGiftCardPurchaseInitialFormData(),setTimeout(function(){fieldday.PhoneInput();var a=e("#giftmsg").text();e("#giftcardmsg").text(a),e("#giftmsg").keyup(function(){var a=this.value;e("#giftcardmsg").text(a)})},100))})}),e("body").on("click","p.km_installments_heading",function(){var a={action:"km_set_checkoutpayments"},s=e(this).find("i#km_checkoutpayments").data("sessionid");s&&(a.session_id=s),t.makeCall(fieldday_ajax.ajax_url,a,function(e){t.displayModal(e,"modal-small km_payment_installment")})}),e(document).on("click",".atc_prev_step",function(){t.display_atc_prev_step()}),e(document).on("click",".km_cart_toggle",function(){t.updatefielddayCart(e(this).parent().find("#km_cart_items_wrap"))}),e(document).on("click",".km_slidefilter_btn a",function(){e(".km_filter_slide").css({left:"0px"}).addClass("fieldday_filter_open"),e(".km_SessionsSection").css({"margin-left":"210px",width:"85%"})}),e(document).on("click",".removefilterselecter",function(a){a.stopPropagation(),jQuery(".km_filter_slide").css({left:"-100%"}).removeClass("fieldday_filter_open"),e(".km_SessionsSection").css({"margin-left":"0px",width:"100%"})}),e(document).on("click",".mobile_bttn",function(){t.updatefielddayCartMobile()}),e(document).on("click",".km_remove_cart_item",function(){e("[id=km_cart_items_wrap]").addClass("fieldday_ajax_processing"),e("#km_cart_items_wrap_mobile").addClass("fieldday_ajax_processing");var a=e(this).data("cart-key"),s=e(this).data("actionfrom");t.makeCall(fieldday_ajax.ajax_url,{action:"km_remove_cart_item",cart_key:a},function(a){"success"==a.status?(e("#km_cart_items_wrap_mobile").html(a.content),e("[id=km_cart_items_wrap]").html(a.content),e("[id=km_cart_total_count]").html(a.items),e("#KmStickyWidgetAddToCartIcon_total_count").length&&e("[id=KmStickyWidgetAddToCartIcon_total_count]").html(a.items),e(".mobile_cart_count").html(a.items),e("#km_cart_items_wrap_mobile a.km_btn").after("<p class='continue_shopping_cart'><a href='/purchase/'>Continue Shopping</a></p>"),e("#km_cart_items_wrap_mobile").removeClass("fieldday_ajax_processing"),e("[id=km_cart_items_wrap]").removeClass("fieldday_ajax_processing"),"cart"!==s&&t.UpdateCart(),e(".mobile_cart_count").text()<1?e(".cart_bttn_mobile").addClass("mobile_cart_count_0"):e(".cart_bttn_mobile").removeClass("mobile_cart_count_0")):t.DisplayAlert("error","error to get the cart information")})})},cartOnScroll:function(){let a=!1;e(".km_addtocart_modal .km_modal_content").scroll(function(){e(this).scrollTop()<50&&(a=!1,e(".km_atc_header").show()),a&&t.inRange(e(this).scrollTop(),45,55)||(e(this).scrollTop()>50?(a=!0,e(".km_atc_header").hide()):(a=!1,e(".km_atc_header").show()))})},updateDate:function(a){e(".custom_dob_error").remove();var t=!1;return a.find(".km_dob_wrap").each(function(){var a=e(this).find(".km_date_year").val()+"-"+e(this).find(".km_date_month").val()+"-"+e(this).find(".km_date_day").val(),s=moment(a),i=e(this).data("age-from"),r=e(this).data("age-to"),n=moment().diff(a,"years",!1);s.isBefore(moment(),"day")&&s.isValid()||(e(this).append("<span class='custom_dob_error'>Date is invalid</span>"),t=!0),(n<i||n>r)&&(e(this).find(".custom_dob_error").remove(),e(this).append("<span class='custom_dob_error'>Age limit for this activity is "+i+"y - "+r+"y.</span>"),t=!0,e(this).find(".km_date_year").focus()),e(this).find(".km_hidden_dob").val(a)}),!t},updateSessionToCart:function(a){var s=new FormData(e("#km_add_to_cart_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_cartitems",s,function(a){var s;"success"==a.status?(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?(t.updatefielddayCartMobile(),e(".cart_bttn_mobile").removeClass("mobile_cart_count_0")):t.updatefielddayCart(e("[id=km_cart_items_wrap]")),window.clearTimeout(s),s=setTimeout(function(){e("#km_cart_items_wrap").css("right","-370px")},5e3),t.closepopup()):t.DisplayAlert("error",a.message)})},addSessionToWaitlist:function(){var a=new FormData(e("#km_add_to_cart_form")[0]),s=e("#km_add_to_cart_form");t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_waitlistitems",a,function(e){"success"==e.status?(s.hide(),s.parents(".km_modal_content").find(".thank-you-section").show(),s.parents(".km_addtocart_modal").find(".km_modal_footer").hide()):t.DisplayAlert("error",e.message)})},addSessionToCart:function(a,s){var i=new FormData(e("#km_add_to_cart_form")[0]);i.append("checkoutRediect",s),t.postFormData(fieldday_ajax.ajax_url+"?action=km_set_cartitems",i,function(s){var i;"success"==s.status?(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?(t.updatefielddayCartMobile(),e(".cart_bttn_mobile").removeClass("mobile_cart_count_0")):t.updatefielddayCart(e("[id=km_cart_items_wrap]")),window.clearTimeout(i),i=setTimeout(function(){e("#km_cart_items_wrap").css("right","-370px")},5e3),s.pageredirect&&(window.location.href=s.pageredirect+"?cart=true"),a?window.location.href=a:t.closepopup(),e("#km_session_filter_form").length&&t.processSessionFilters()):t.DisplayAlert("error",s.message)})},updatefielddayCart:function(a){e(".km_cart_page").length||e("#km_cart_items_wrap").css({right:"0px"}).html("").addClass("fieldday_ajax_processing"),t.makeCall(fieldday_ajax.ajax_url,{action:"get_cart_data"},function(s){"success"==s.status?(a&&a.html(s.content),e("#km_cart_total_count").length&&e("[id=km_cart_total_count]").html(s.items),e("#KmStickyWidgetAddToCartIcon_total_count").length&&e("[id=KmStickyWidgetAddToCartIcon_total_count]").html(s.items)):t.DisplayAlert("error","error to get the cart information"),e("[id=km_cart_items_wrap]").removeClass("fieldday_ajax_processing")},!0)},updatefielddayCartMobile:function(){e("#km_cart_items_wrap_mobile").css({top:"10px",left:"10px",right:"10px"}).html("").addClass("fieldday_ajax_processing"),t.makeCall(fieldday_ajax.ajax_url,{action:"get_cart_data"},function(a){"success"==a.status?(e("#km_cart_items_wrap_mobile").html(a.content),e(".mobile_cart_count").html(a.items),e(".cart_bttn_mobile").removeClass("mobile_cart_count_0"),e("#km_cart_items_wrap").html(a.content),e("[id=km_cart_total_count]").html(a.items),e("#KmStickyWidgetAddToCartIcon_total_count").length&&e("[id=KmStickyWidgetAddToCartIcon_total_count]").html(a.items)):t.DisplayAlert("error","error to get the cart information"),e("#km_cart_items_wrap_mobile").removeClass("fieldday_ajax_processing"),e("button.mobile_bttn").css({display:"none"}),e("#km_cart_items_wrap_mobile a.km_btn").after("<p class='continue_shopping_cart'><a href='/purchase/'>Continue Shopping</a></p>"),a.items>3?e("#km_cart_items_wrap_mobile ul").css("height","550px"):e("#km_cart_items_wrap_mobile ul").css("height","auto")},!0)},saveKidsIntoLocal:function(){var a=JSON.parse(t.getCookie("km_saved_kids"));a||(a={});var s=e("#km_add_to_cart_form").serializeJSON().ATC.kids;e.each(s,function(e,t){var s=t.school;t.school={},t.school._id=s,a[t._id]=t}),t.setCookie("km_saved_kids",JSON.stringify(a))},setCookie:function(e,a,t){var s="";if(t){var i=new Date;i.setTime(i.getTime()+24*t*60*60*1e3),s="; expires="+i.toUTCString()}document.cookie=e+"="+(a||"")+s+"; path=/"},getTimezoneOffset:function(){let e=(new Date).getTimezoneOffset();var a=(e<0?"":"-")+(e=Math.abs(e));a&&t.setCookie("offset",a)},setGiftCardPurchaseInitialFormData:function(){let a=localStorage.getItem("kmGiftCardPurchaseData_recipientname")||"",t=localStorage.getItem("kmGiftCardPurchaseData_sendername")||"",s=localStorage.getItem("kmGiftCardPurchaseData_usergiftmsg")||"",i=localStorage.getItem("kmGiftCardPurchaseData_recipientemail")||"",r=localStorage.getItem("kmGiftCardPurchaseData_recipientphone_code"),n=localStorage.getItem("kmGiftCardPurchaseData_r_phone_org_no")||"",o=(localStorage.getItem("kmGiftCardPurchaseData_recipientphone"),localStorage.getItem("kmGiftCardPurchaseData_sendmethod")),d=localStorage.getItem("kmGiftCardPurchaseData_amount"),_=e(".km_giftsendoption .km_sendoption_value").filter(function(){return e(this).text().trim()===o}),l=localStorage.getItem("kmGiftCardPurchaseData_gft_img")||1;e(".km_single_giftcardpopup .km_single_giftdesign").length-1>=l?e(".km_single_giftcardpopup .km_single_giftdesign:eq("+l+") img").trigger("click"):e(".km_single_giftcard .km_single_giftdesign:first-child img").trigger("click"),_.length>0&&_.click();let m=e(".km_gift_values_wrap .km_gift_value").filter(function(){return e(this).text()===d});if(m.length>0)m.click();else{let a=e(".km_gift_values_wrap").find(".km_gift_value").last();e(".giftcardprice").text(d),e(".input#km_gift_custom_amount").val(d),a.click()}e('.km_gift_frm_field #giftCardForm [name="recipientname"]').val(a),e('.km_gift_frm_field #giftCardForm [name="recipient_email"]').val(i),e('.km_gift_frm_field #giftCardForm [name="usergiftmsg"]').val(i),e('.km_gift_frm_field #giftCardForm [name="sender_name"]').val(t),e('.km_gift_frm_field #giftCardForm [name="usergiftmsg"]').val(s),r&&""!=r&&(e('.km_gift_frm_field #giftCardForm [name="parent_phone_gift_code"]').val(r),e('.km_gift_frm_field #giftCardForm [name="parent_phone_gift_org_number"]').val(n),e('.km_gift_frm_field #giftCardForm [name="recipient_phone"]').val(n))},getCookie:function(e){for(var a=e+"=",t=document.cookie.split(";"),s=0;s<t.length;s++){for(var i=t[s];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(a))return i.substring(a.length,i.length)}return null},inRange:function(e,a,t){return e>=a&&e<=t},registerSession:function(a,s,i,r,n){t.makeCall(fieldday_ajax.ajax_url,{action:"km_display_cartform",sessionId:a,tagId:s,sessionDate:i,sessionfeatured:r,waitlist:n},function(r){"success"==r.status?(t.displayModal(r,"modal-large km_addtocart_modal"),e(".km_guest_personalinfo").length?(e(".km_add_to_cart,.km_cartguest_back").css("display","none"),e(".km_cartguest_continue").css("display","inline-block")):(e(".km_cartguest_continue , .km_cartguest_back").css("display","none"),e(".km_add_to_cart").css("display","inline-block")),_=a,l=s,m=i,t.scrollTo(),t.requiredfields(),t.BookingSelection(),t.BookingCalander(),t.MultiWeekBookingCalander(),t.cartOnScroll(),t.checkoutpageevents(),t.fielddaySessionTime(),t.PhoneInput()):t.DisplayAlert("error",r.message)})},registerEvent:function(e,a,s,i){t.makeCall(fieldday_ajax.ajax_url,{action:"km_display_eventcartform",sessionId:e,tagId:a,sessionDate:s,sessionfeatured:i},function(i){"success"==i.status?(t.displayModal(i,"modal-large km_addtocart_modal km_event_modal"),_=e,l=a,m=s,t.requiredfields(),t.PhoneInput(),t.cartOnScroll(),t.fielddaySessionTime(),t.inputincrement(),t.fielddaySessionTime(),t.checkoutpageevents(),t.AddressAutoComplete()):t.DisplayAlert("error",i.message)})},registerPackage:function(a,s){t.makeCall(fieldday_ajax.ajax_url,{action:"km_display_packageform",sessionId:a,packageId:s},function(i){if("success"==i.status){t.displayModal(i,"modal-large km_package_modal km_addtocart_modal"),e(".package_payment_section, .km_package_btns").hide();var r=[i.prices];e(".store_json").attr("data-json",JSON.stringify(r)),s,_=a,t.requiredfields(),t.cartOnScroll(),t.checkoutpageevents(),t.fielddaySessionTime(),t.AddressAutoComplete()}else t.DisplayAlert("error",i.message)})},InstallmentPlans:function(e,a,s,i){t.makeCall(fieldday_ajax.ajax_url,{action:"km_display_plans",sessionId:e,tagId:a,sessionDate:s,sessionfeatured:i},function(i){"success"==i.status?(t.displayModal(i,"modal-large km_addtocart_modal"),_=e,l=a,m=s,t.requiredfields(),t.cartOnScroll()):t.DisplayAlert("error",i.message)})},siblingDiscount:function(a,s){var i=new FormData;e(a).is(":checked")?i.set("astatus","apply"):i.set("astatus","remove"),t.postFormData(fieldday_ajax.ajax_url+"?action=km_apply_sibling_discount",i,function(e){"success"==e.status?t.UpdateCart():(t.kmRemoveLoader(),t.DisplayAlert("error",e.message))},!0)},merchandiseevents:function(){e(document).on("change",".km_merchandise",function(){if(e(this).is(":checked")){e(".km_session_type").prop("checked",!1);var a=e("#layoutdesign").val();t.makeCall(fieldday_ajax.ajax_url,{action:"km_get_bankdays",data:a},function(a){"success"==a.status?(e(".km_provider_sessions").hide(),e(".km_provider_merchandise").html(a.content).show()):"fail"==a.status&&t.DisplayAlert("error",a.message)})}else e("#km_session_filter_form").length&&t.processSessionFilters()}),e(document).on("click",".purchase_merchandise",function(){e("#fieldday_merchandise_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"merchandise_field"}).done(function(){t.StripeProcess(e("#fieldday_merchandise_form"),function(a){if(a.error)t.DisplayAlert("error",a.error.message),t.km_btn_RemoveLoader("km_purchase_merchandise_pc"),t.kmRemoveLoader();else{e("#fieldday_merchandise_form .merchandise_stripeToken").val(a.id);var s=new FormData(e("#fieldday_merchandise_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_merchandise_process",s,function(e){"success"==e.status?t.displayModal(e):t.DisplayAlert("error",e.message)},"","km_purchase_merchandise_pc")}},!0,"km_purchase_merchandise_pc")})})},registerSessionTiming:function(a,s){var i={action:"km_registerSessionTiming"},r=e(a).data("session-id"),n=e(a).data("session-featured"),o=e(a).data("offer-id"),d=e(a).data("offer-name");if(r){var u=e(a).data("tag-id"),k=e(a).data("session-date");i.session_id=r,i.tagId=u,i.session_date=k,i.sessionfeatured=n,_=r,l=u,m=k}o&&(i.offerId=o,i.offername=d,c=o,p=d),t.makeCall(fieldday_ajax.ajax_url,i,function(e){t.displayModal(e,"modal-large"),t.fielddaySessionTime()})},hasCart:function(){"cart=true"==document.URL.split("?")[1]&&(t.updatefielddayCart(e("[id=km_cart_items_wrap]")),setTimeout(function(){e("#km_cart_items_wrap").css("right","-370px")},5e3)),e("body").on("click","#sessiontimenext",function(){var e,a,s,i=[];jQuery(":checkbox:checked").each(function(t){sessionfullweek=jQuery(this).data("sessionfullweek"),sessionfullweek?i="":i.push(this.value),e=jQuery(this).data("session-id"),a=jQuery(this).data("session-tag"),s=jQuery(this).data("session-featured")}),null!=e?t.registerSession(e,a,i,s):t.DisplayAlert("error","Please Select Date!")})},countItmeCart:function(){var a=e(".mobile_cart_count").text();a<1?e(".cart_bttn_mobile").addClass("mobile_cart_count_0"):e(".cart_bttn_mobile").removeClass("mobile_cart_count_0"),a>4?e("#km_cart_items_wrap_mobile ul").css("height","550px"):e("#km_cart_items_wrap_mobile ul").css("height","auto");e("#km_cart_total_count").text();a>4?e("#km_cart_items_wrap ul").css("height","550px"):e("#km_cart_items_wrap ul").css("height","auto")},registermerchandise:function(e,a){t.makeCall(fieldday_ajax.ajax_url,{action:"km_merchandise_form",offerId:e,offername:a},function(s){t.displayModal(s,s.modalclass),c=e,p=a,t.requiredfields(),t.PhoneInput(),t.CardInput()})},kmRemoveExtraSpacesFromValue:function(e,t,s=!1,i=!1){clearTimeout(a);let r=()=>{t.target.value=t.target.value.trim(),t.target.value=t.target.value.replace(/http:|https:|script|src=|\/|\.js|<|>/gi,"")};a=s?i?setTimeout(r,i):setTimeout(r,2e3):i?setTimeout(r,i):setTimeout(r,1700)},login:function(a,s,i=""){s.preventDefault();let r=s.target.id;e(a).parents("form").parsley(t.settings.parsley_valiation_options_register).whenValidate({group:"km_login"}).done(function(){var s=new FormData(e("#km_login_form")[0]);t.postFormData(fieldday_ajax.ajax_url,s,function(e){e.isGuest&&!h&&window.location.reload(),t.afterLogin(e,a,r)},!0,r)})},LoginWithFacebook:function(){let e=t.getCookie("sessionclicked");e&&(open_session=e);var a={action:"km_social_login",AuthCode:k,client:"facebook",openpopup:open_session};t.makeCall(fieldday_ajax.ajax_url,a,function(e){t.afterLogin(e)})},LoginWithGoogle:function(){let e=t.getCookie("sessionclicked");e&&(open_session=e);var a={action:"km_social_login",AuthCode:k,client:"google",openpopup:open_session};t.makeCall(fieldday_ajax.ajax_url,a,function(e){t.afterLogin(e)})},register:function(a,s){s.preventDefault(),e(a).parents("form").parsley(t.settings.parsley_valiation_options_register).whenValidate({group:"register"}).done(function(){var s=new FormData(e("#km_register_form")[0]);t.postFormData(fieldday_ajax.ajax_url,s,function(e){t.afterLogin(e,a,"signup-submit")},"","signup-submit")})},updateParent:function(a,s){s.preventDefault(),e(a).hasClass("disabled")||e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"profile_fields"}).done(function(){var s=new FormData(e("#profile_update")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_profile",s,function(e){"success"==e.status?t.DisplayMessage(a,"success",e.message):t.DisplayMessage(a,"error",e.message)})})},updatePassword:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){var i=new FormData(e("#km_reset_password_form")[0]);jQuery("#km_reset_password_form").parsley().validate()?t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_password",i,function(s){"success"==s.status?(e("#km_reset_password_form")[0].reset(),t.DisplayMessage(a,"success",s.message)):t.DisplayMessage(a,"error",s.message)}):t.DisplayMessage(a,"error","Please fill all the related details.")}},profileForm:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){var i={page:e(a).attr("id"),action:"km_profile_tab",dataId:e(a).data("id")};t.makeCall(fieldday_ajax.ajax_url,i,function(s){"success"==s.status?(e(".km_tab_data").html(""),e(".km_nav_link").removeClass("km_active"),e(".km_nav_link").removeClass("km_primary_color"),e(a).addClass("km_active"),e(a).addClass("km_primary_color"),e(".km_tab_data").html(s.content),t.PhoneInput(),t.requiredfields(),t.fielddaySelect(),t.fielddaySessionTime()):"fail"==s.status&&t.DisplayAlert("error",s.message)})}e(".km_view_all_prctpants_pg_ctm_new").length&&e(".km_view_all_prctpants_pg_ctm_new").toggleClass("open-sidebar")},creditStatementFilter:function(a,s){e(".km_credit_filter").removeClass("km_cred_filter_active"),e(".km_credit_filter").removeClass("km_primary_bg"),e(".km_credit_filter").removeClass("km_primary_color"),e(a).addClass("km_cred_filter_active"),e(a).addClass("km_primary_bg");var i={page:"store_statement",action:"km_profile_tab",isPerdayCredit:s};t.makeCall(fieldday_ajax.ajax_url,i,function(a){"success"==a.status?(e(".km_tab_data").html(""),e(".km_tab_data").html(a.content),e(".km_credit_filter").removeClass("km_cred_filter_active"),e(".km_credit_filter").removeClass("km_primary_bg"),e(".km_credit_filter").addClass("km_primary_color"),"true"==s?(e(".km_day_credit").addClass("km_cred_filter_active"),e(".km_day_credit").addClass("km_primary_bg"),e(".km_day_credit").removeClass("km_primary_color")):"false"==s&&(e(".km_dollar_credit").addClass("km_cred_filter_active"),e(".km_dollar_credit").addClass("km_primary_bg"),e(".km_dollar_credit").removeClass("km_primary_color"))):"fail"==a.status&&t.DisplayAlert("error",a.message)})},ajaxPurchase:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){e(".km_pagination li").removeClass("km_pagination_active"),e(a).find("a").addClass("km_primary_color"),e(a).addClass("km_pagination_active");var i={pagenumber:e(a).data("page"),action:"km_get_purchase"};e(".km_pagination_active").find("a").removeClass("km_primary_color"),t.makeCall(fieldday_ajax.ajax_url,i,function(a){"success"==a.status?(e(".km_tab_data").html(""),e(".km_tab_data").html(a.content),e(".km_pagination_active").find("a").removeClass("km_primary_color"),t.fielddaySessionTime()):"fail"==a.status&&t.DisplayAlert("error",a.message)})}},ajaxPagination:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){e(".km_pagination li").removeClass("km_pagination_active"),e(a).find("a").addClass("km_primary_color"),e(a).addClass("km_pagination_active"),e(".km_pagination_active").find("a").removeClass("km_primary_color");var i={pagenumber:e(a).data("page"),action:"km_get_pagination"};t.makeCall(fieldday_ajax.ajax_url,i,function(a){"success"==a.status?(e(".km_pagination_data").html(""),e(".km_pagination_data").html(a.content),e(".km_pagination_active").find("a").removeClass("km_primary_color")):"fail"==a.status&&t.DisplayAlert("error",a.message)})}},readURL:function(a){if(a.files&&a.files[0]){var t=new FileReader;t.onload=function(t){e(a).parents(".profile-pic-upload").find(".preview-img").attr("src",t.target.result).show(),e(a).parents(".profile-pic-upload").find(".km_default_avatar").hide()},t.readAsDataURL(a.files[0])}},afterLogin:function(a,s,i=""){var r=null;if(r=u?u.split("_"):[],"success"==a.status)if(i&&""!=i&&t.km_btn_RemoveLoader(i),r[1]&&(_=r[1]),r[4]&&(c=r[4]),s&&t.DisplayMessage(s,"success",a.message),a.popup&&window.location.replace(window.location.href+"?session="+a.popup),c)t.registermerchandise(c,p),o=!0,t.updateMenu();else if(_&&!h&&"event"!==g){r[2]&&(l=r[2],e(".km_session_type[value="+l+"]").prop("checked",!0).trigger("change")),r[3]&&(m=r[3]);var k="";if("waitlist"==g)k=g;t.registerSession(_,l,m,a.sessionfeatured,k),o=!0,t.updateMenu()}else h?(t.registerPackage(_),o=!0,t.updateMenu()):"event"==g?(t.registerEvent(_),o=!0,t.updateMenu()):a.redirect?window.location=a.redirect:a.redirect_page_&&(window.location=a.redirect_page_);else"varificationsent"==a.status?(i&&""!=i&&t.km_btn_RemoveLoader(i),t.kmRemoveLoader(),t.displayModal(a,"km_addtocart_modal verification_popup"),t.OtpInput(),t.PhoneInput(),t.OTPTimer(n,!0)):"nophone"==a.status?(i&&""!=i&&t.km_btn_RemoveLoader(i),t.kmRemoveLoader(),t.displayModal(a),t.OtpInput(),t.PhoneInput()):(i&&""!=i&&t.km_btn_RemoveLoader(i),t.kmRemoveLoader(),s?t.DisplayMessage(s,"error",a.message):alert(a.message));try{d?grecaptcha.reset(d):grecaptcha.reset()}catch(e){}},deleteSavedCard:function(a){confirm("Are you sure to delete this card?")&&t.makeCall(fieldday_ajax.ajax_url,{action:"km_delete_saved_card",cardId:a},function(a){"success"==a.status?e("#saved_cards").trigger("click"):t.DisplayAlert("error",a.message)})},newCardForm:function(e){t.makeCall(fieldday_ajax.ajax_url,{action:"km_card_form",cardId:e},function(e){"success"==e.status?(t.displayModal(e,"add_nwcrd_km_mdl_cls"),t.CardInput()):t.DisplayAlert("error",e.message)})},addNewCard:function(){e("#km_card_form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"add_new_card"}).done(function(){t.StripeProcess(e("#km_card_form"),function(a){if(a.error)t.DisplayAlert("error",a.error.message);else{e("#_stripeToken").val(a.id);var s=new FormData(e("#km_card_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_save_card",s,function(a){"success"==a.status?(t.DisplayAlert("success",a.message),e("#saved_cards").trigger("click"),t.closepopup()):t.DisplayAlert("error",a.message)})}})})},setDefaultCard:function(a){confirm("Are you sure to set this card as default?")&&t.makeCall(fieldday_ajax.ajax_url,{action:"km_setdefault_card",cardId:a},function(a){"success"==a.status?e("#saved_cards").trigger("click"):t.DisplayAlert("error",a.message)})},updateMenu:function(){t.makeCall(fieldday_ajax.ajax_url,{action:"km_getmenu_data"},function(a){if("success"==a.status&&!e("#menu_item_km_userinfo").length){let t=e("#"+a.menuId);0==e("#"+a.menuId).length&&(t=e("#"+a.slug)),t.append(a.html),e("body").append(a.afterLoginScript)}},!0)},verifyOtp:function(a,s){s.preventDefault();var i=new FormData(e("#km_verification_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_verify_otp",i,function(e){"success"==e.status?(t.DisplayMessage(a,"success",e.message),t.afterLogin(e)):t.DisplayMessage(a,"error",e.message)})},LoginverifyOTP:function(a,s){s.preventDefault();var i=new FormData(e("#km_verification_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_login_verify_otp",i,function(e){"success"==e.status?(t.DisplayMessage(a,"success",e.message),t.afterLogin(e,"","km_verify_submit")):(t.km_btn_RemoveLoader("km_verify_submit"),t.DisplayMessage(a,"error",e.message))},"","km_verify_submit")},OtpInput:function(){e(document).on("keyup",".km_otp_number",function(a){e(".otp_number_error").text(""),8==a.which?e(this).prev(".km_otp_number").focus():e(this).val().length>=1&&(a.preventDefault(),e(this).next(".km_otp_number")?/\D/g.test(this.value)?(this.value=this.value.replace(/\D/g,""),e(".otp_number_error").text("Please enter all 4 digits")):e(this).next(".km_otp_number").focus():e(this).blur())})},updatePhone:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){var i=new FormData(e("#km_newphone_form")[0]);e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"newphone_update"}).done(function(){t.postFormData(fieldday_ajax.ajax_url+"?action=km_update_phone",i,function(e){"success"==e.status?(t.displayModal(e),t.DisplayMessage(a,"success",e.message),t.OTPTimer(n,!0),t.PhoneInput(),t.closePhoneUpdate()):t.DisplayMessage(a,"error",e.message)})})}},otpEvents:function(){e(document).on("change",".km_verify_code_type",function(a){var s=e(this).val();if(e(".km_verifcatio_hl_txt").removeClass("km_hidden"),e(".km_inline_message").hide(),t.OTPTimer(0,!0),"sms"==s)void 0!==e(this).attr("data-email")?t.LoginresendOtp(e(this),a):t.resendOtp(e(this),a),e(".km_verification_via_email .km_verifcatio_hl_txt").addClass("km_hidden");else if("email"==s){void 0!==e(this).attr("data-email")?t.LoginresendOtp(e(this),a):t.resendOtp(e(this),a),e(".km_verification_via_sms .km_verifcatio_hl_txt").addClass("km_hidden")}})},resendOtp:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){var i=new FormData(e("#km_verification_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_resend_otp",i,function(e){"success"==e.status?(t.DisplayMessage(a,"success",e.message),t.OTPTimer(n,!0),t.PhoneInput(),t.closePhoneUpdate()):t.DisplayMessage(a,"error",e.message)})}},LoginresendOtp:function(a,s){if(s.preventDefault(),!e(a).hasClass("disabled")){var i=new FormData(e("#km_verification_form")[0]),r=e(a).attr("data-email");i.set("isEmailOTP",r),t.postFormData(fieldday_ajax.ajax_url+"?action=km_loginresend_otp",i,function(e){"success"==e.status?(t.DisplayMessage(a,"success",e.message),t.OTPTimer(n,!0),t.PhoneInput(),t.closePhoneUpdate()):t.DisplayMessage(a,"error",e.message)})}},OTPTimer:function(a,s){s&&r&&clearTimeout(r);var n=Math.floor(a/60),o=a%60;n=n<10?"0"+n:n,o=o<10?"0"+o:o,e(".km_verification_form .otp_timer").html(n+":"+o).show(),(a-=1)>=0&&i?r=setTimeout(function(){e(".km_verification_form .resend_otp").addClass("disabled"),t.OTPTimer(a)},1e3):i&&(e(".km_verification_form .otp_timer").html(""),e(".km_verification_form .resend_otp").removeClass("disabled"))},openPhoneUpdate:function(){e(".km_otp_verification_wrap").hide(),e(".km_updatephone_wrap").show()},closePhoneUpdate:function(){jQuery(".km_otp_number").val(""),e(".km_otp_verification_wrap").show(),e(".km_updatephone_wrap").hide()},DateInput:function(){e(".km_date_field").datepicker({format:"mm-dd-yy",minDate:0})},kmProviderCountryCode:function(){let e=fieldday_ajax.fieldday_provider_dial_code;return void 0===e&&(e="1"),e},PhoneInput:function(){e(".km_phone_field").each(function(){var t=e(this).attr("id"),s=document.querySelector("#"+t),i=e("#"+t).parents(".km_field_wrap").find(".country_code").val();if(void 0===(n=fieldday_ajax.fieldday_provider_country_code)&&(n="US"),i){var r=fieldday.settings.allCountries[i];if(void 0!==r&&(n=r),e(".users_countrycode").length)var n=e("#"+t).parents(".km_field_wrap").find(".users_countrycode").val()}if(t){var o=window.intlTelInput(s,{initialCountry:n,placeholderNumberType:"FIXED_LINE"});s.addEventListener("countrychange",function(a){var i=o.getSelectedCountryData().dialCode;n=o.getSelectedCountryData().iso2,e("#"+t).parents(".km_field_wrap").find(".country_code").val(i),e(".users_countrycode").length&&e("#"+t).parents(".km_field_wrap").find(".users_countrycode").val(n);var r=this.value.replace(/ /g,"");e("#"+t).parents(".km_field_wrap").find(".phone_number").val(r),this.value="",e("#"+t).parents(".km_field_wrap").find(".phone_number").val(""),new Cleave(s,{phone:!0,phoneRegionCode:n.toUpperCase()})}),s.addEventListener("keyup",function(i){var r=this.value.replace(/ /g,"");e("#"+t).parents(".km_field_wrap").find(".phone_number").val(r),clearTimeout(a);a=setTimeout(()=>{o.getSelectedCountryData().iso2;new Cleave(s,{phone:!0,phoneRegionCode:n.toUpperCase()})},100)})}if(n)var d=n.toUpperCase();else void 0===(d=fieldday_ajax.fieldday_provider_country_code)&&(d="US");new Cleave(s,{phone:!0,phoneRegionCode:d})})},CardInput:function(){e(".km_card_number").each(function(){var a=e(this).attr("id"),t=e(this),s=document.querySelector("#"+a);a&&new Cleave(s,{creditCard:!0,onCreditCardTypeChanged:function(e){t.next().removeAttr("class"),t.next().addClass("km_card_type "+e)}})})},ClearSessionFilters:function(a){e(window).bind("pageshow",function(){e(a).length&&e(a)[0].reset()})},fielddaySessionTime:function(){e(".km_session_single_item, .km_package_detail, .km_elem_dt,.km_km_order-placed").length&&e(".km_session_single_item, .km_package_detail, .km_elem_dt,.km_km_order-placed").each(function(){var a=e(this).attr("data-time-stamp-from"),t=e(this).attr("data-time-stamp-to"),s=e(this).find(".km_session_month"),i=e(this).find(".km_session_year"),r=e(this).find(".km_session_fulldate"),n=e(this).find(".km_session_fulldate_order"),o=e(this).find(".km_sess_time"),d=e(this).find(".km_sess_time_order"),_=e(this).find(".km_session_month_wd_strt_andd_year"),l=moment.utc(a).local().format("MMM DD"),m=moment.utc(t).local().format("MMM DD"),c=moment.utc(a).local().format("YYYY"),p=moment.utc(t).local().format("YYYY"),u=moment.utc(a).local().format("h:mm a"),k=moment.utc(t).local().format("h:mm a");a&&t&&(e(s).html(l+" - "+m),r.html(l+", "+p+" - "+m+", "+p),n.html(l+", "+c+" - "+m+", "+p),e(i).html(p),e(o).html(u+" - "+k),e(d).html(u+" - "+k),e(_).html(l+", "+c))})},InitSessionFilter:function(){},process_personal_info:function(a,s){s.preventDefault();var i=e(a).parents("form");i.find(".km_parent_kids").val();var r=e(a).data("group");e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:r}).done(function(){t.NextStep(),e(".single_kid_info").length?(e(".km_participant_form_text").removeClass("km_hidden"),e(".km_participant_form_notrequired_text").addClass("km_hidden")):(e(".km_participant_form_notrequired_text").removeClass("km_hidden"),e(".km_participant_form_text").addClass("km_hidden"));var a=new FormData(e("#km_purchase_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_parent_info",a,function(e){},!1)})},process_kid_info:function(a,s){s.preventDefault();var i=e(a).data("group");e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:i}).done(function(){var a=e(".fieldday_form_button.Form_Error").length;e("#storeCreditId").remove(),0==a?o?t.checkStoreCredit(function(e){"success"==e.status?t.displayModal(e,"km_storecredit_modal"):(t.UpdateCart(),t.NextStep())}):(t.UpdateCart(),t.NextStep()):t.DisplayAlert("error",fieldday_ajax.invalid_form_message)})},process_coupon_apply:function(a,s,i=""){s.preventDefault();var r=new FormData;i&&""!=i&&(e('input[name="couponCode"]').val(""),r.set("couponCode",""));var n=e('input[name="couponCode"]').val();r.set("couponCode",n),e("#km_checkoutcart_detail").addClass("fieldday_ajax_processing"),t.postFormData(fieldday_ajax.ajax_url+"?action=km_Apply_CouponCart",r,function(e){"success"==e.status?(""!=e.message&&t.DisplayAlert("success",e.message),t.UpdateCart()):(t.DisplayAlert("error",e.message),t.kmRemoveLoader())},!0)},checkStoreCredit:function(a){e("#manualStoreCreditPaid, #storeCreditId, #applySiblingDiscount").remove();var s=new FormData(e("#km_purchase_form")[0]);t.postFormData(fieldday_ajax.ajax_url+"?action=km_check_store_credit",s,function(e){a(e)})},process_purchase:function(a,s){s.preventDefault();var i=e(a).data("group");let r=a.id;e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:i}).done(function(){if(!0===t.paymentrequired){var s=e(a).parents("form");t.StripeProcess(s,function(s){s.error?(e("#_stripeToken").val(""),t.km_btn_RemoveLoader(r),t.kmRemoveLoader(),t.DisplayAlert("error",s.error.message)):(e("#_stripeToken").val(s.id),t.processPurchaseAPI(a))},!0,r)}else t.processPurchaseAPI(a)})},processPurchaseAPI:function(a){var s=new FormData(e("#km_purchase_form")[0]);e("#km_checkoutcart_detail").addClass("fieldday_ajax_processing"),t.postFormData(fieldday_ajax.ajax_url+"?action=km_purchase",s,function(s){"success"==s.status?""!=s.status?window.location.href=s.redirect:(e(a).parents(".km_purchase_form_content").html(s.content),t.scrollTo(".km_session_purchase")):t.DisplayAlert("error",s.message)},"",a.id)},process_purchaseDetail:function(a,s){s.preventDefault();var i=e(a).data("group");e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:i}).done(function(){t.UpdateCart(),t.NextStep()})},StripeProcess:function(e,a,s,i=""){var r={},n=!1;r.number=e.find(".km_card_number").val(),r.cvc=e.find(".km_card_cvc").val(),r.exp_month=e.find(".km_card_expiry_month").val(),r.exp_year=e.find(".km_card_expiry_year").val();var o=e.find(".package_id").val();if(s)n=!0;t.km_loader(),i&&""!=i&&t.km_btn_loader(i),Stripe.card.createToken(r,function(e,s){t.postFormData(fieldday_ajax.ajax_url+"?action=km_process_stripe",{token:s.id,fullresponse:s},function(){},n),a(s),o&&t.km_loader()})},getSchoolData:function(a,s,i,r){var n=e(a).val(),o=e(a).parents(".km_kids_fields_wrap");n?t.makeCall(fieldday_ajax.ajax_url,{action:"get_school_info",schoolId:n},function(a){if("success"==a.status){if(o.find(".km_school_tracks").remove(),a.schools.tracks.length){var s=e("<div class='km_col_4 km_field_wrap km_school_tracks'>").appendTo(o);s.append("<label>Track</label>");var i=e('<select data-name="track" class="km_input" name="'+r+'">').appendTo(s);e.each(a.schools.tracks,function(a,t){var s=t.replace("track_","");i.append(e("<option></option>").val(t).html(s))})}}else t.DisplayAlert("error",a.message)}):o.find(".km_school_grades, .km_school_tracks").remove()},openClaimForm:function(e,a){a.preventDefault(),t.makeCall(fieldday_ajax.ajax_url,{action:"km_display_claim_form"},function(e){"success"==e.status?t.displayModal(e):"fail"==e.status&&t.DisplayAlert("error",e.message)})},claimStoreCredit:function(a,s){s.preventDefault();var i=new FormData(e("#km_claimForm")[0]);e(a).parents("form").parsley(t.settings.parsley_valiation_options).whenValidate({group:"claim_code"}).done(function(){e(a).prop("disabled",!0),t.postFormData(fieldday_ajax.ajax_url+"?action=km_claimcredit",i,function(s){"success"==s.status?(e("#store_credit").trigger("click"),t.closepopup()):t.DisplayAlert("error",s.message),e(a).prop("disabled",!1)})})},UpdateCart:function(){var a=new FormData(e("#km_purchase_form")[0]);e("#km_checkoutcart_detail").addClass("fieldday_ajax_processing"),t.postFormData(fieldday_ajax.ajax_url+"?action=km_updateCart",a,function(a){"success"==a.status?(console.log("successdata"),e("#km_checkoutcart_detail").removeClass("fieldday_ajax_processing").html(a.content),0==a.data.payableAmount?(e(".km_payment_column").hide(),e("#_stripeToken").remove(),t.paymentrequired=!1,e(".km_payment_column").find("input, textarea, select").removeAttr("required"),e(".km_checkout_conf_pricedetail").html(a.data.pricedetail)):(t.paymentrequired=!0,e(".km_payment_column").show(),e("#_stripeToken").length||e(".km_purchase_form").prepend("<input type='hidden' name='stripeToken' value='' id='_stripeToken'>"),e(".km_payment_column").find("input:not(.optional), textarea:not(.optional), select:not(.optional)").attr("required",!0),e(".km_checkout_conf_pricedetail").html(a.data.pricedetail),e(".km_checkout_conf_carddetail").html(a.data.cardinfo)),e(".km_payment_option:checked").length||e(".km_payment_option").first().prop("checked",!0),e(".km_payment_option:checked").val()&&(e(".km_payment_wrap").find("input, textarea, select").removeAttr("required"),t.paymentrequired=!1,e("#_stripeToken").remove()),e(".km_default_authpickup").html(a.data.authPickups),t.PhoneInput(),t.kmRemoveLoader()):(t.kmRemoveLoader(),t.DisplayAlert("error",a.message),e("#km_checkoutcart_detail").removeClass("fieldday_ajax_processing"))})},PrevStep:function(){e("._purchase_steps .km_step:eq("+s+")").removeClass("km_active_step"),s--,e(".km_single_step").removeClass("km_active_step"),e(".km_purchase_form_content .km_single_step:eq("+s+")").addClass("km_active_step"),t.scrollTo(".km_session_purchase")},NextStep:function(){s++,e(".km_single_step").removeClass("km_active_step"),e(".km_purchase_form_content .km_single_step:eq("+s+")").addClass("km_active_step"),e("._purchase_steps .km_step:eq("+s+")").addClass("km_active_step"),t.scrollTo(".km_session_purchase")},DisplayAlert:function(a,t){"success"!=a&&"error"!=a||(e(".km_alert_message").removeClass("km_alert_success km_alert_error"),e(".km_alert_message").html(t).show().addClass("km_bounce km_alert_"+a),setTimeout(function(){e(".km_alert_message").hide()},5e3))},DisplayMessage:function(a,t,s){e(".km_inline_message").remove(),"success"!=t&&"error"!=t||(e(a).parents("form").prepend("<div class='km_inline_message'>"+s+"</div>"),e(".km_inline_message").show().addClass("km_alert_"+t))},displayModal:function(a,t){t||(t="modal-normal"),a.header?e("#km_modal .km_modal_heading").html(a.header).show():e("#km_modal .km_modal_heading").hide(),a.content&&e("#km_modal .km_modal_content").html(a.content),a.footer?e("#km_modal .km_modal_footer").html(a.footer).show():e("#km_modal .km_modal_footer").hide(),e("#km_modal .km_modal_content .km_phone_field").length?e("#km_modal .km_modal_content").addClass("km_showoverflow"):e("#km_modal .km_modal_content").removeClass("km_showoverflow"),e(".km_modal_content").animate({scrollTop:0},"fast"),e("#km_modal").removeAttr("class").addClass("km_overlay "+t).show(),e("body").addClass("body_km_open_true")},displaySecondModal:function(a,t){t||(t="modal-normal"),a.header?e("#km_modal_sec .km_modal_heading").html(a.header).show():e("#km_modal_sec .km_modal_heading").hide(),a.content&&e("#km_modal_sec .km_modal_content").html(a.content),a.footer?e("#km_modal_sec .km_modal_footer").html(a.footer).show():e("#km_modal_sec .km_modal_footer").hide(),e("#km_modal_sec .km_modal_content .km_phone_field").length?e("#km_modal_sec .km_modal_content").addClass("km_showoverflow"):e("#km_modal_sec .km_modal_content").removeClass("km_showoverflow"),e("#km_modal_sec .km_modal_content").animate({scrollTop:0},"fast"),e("#km_modal_sec").removeAttr("class").addClass("km_overlay km_modal "+t).show(),e("body").addClass("body_km_open_true")},processSessionFilters:function(a,s){if(s&&s.target&&s.target.id&&"km_location_search"==s.target.id&&t.setCookie("km_purchase_location_form",e("#km_location_search").val()),e("#reportrange").hasClass("activebtn")&&e("#reportrange").removeClass("activebtn"),a){if(a.hasAttributes("data-search-name"))var i=a.getAttribute("data-search-name");if("tagId"==a.getAttribute("name")){console.log("filterclick"),console.log(a);var r=a.getAttribute("value");e('#km_session_filter_form input[name="tagId"]').val(r)}}jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").hasClass("active")&&(jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").removeClass("active"),jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").removeClass("km_primary_border"),jQuery(".km_filter_types #km_wrap_fieldday_all_tab_id").parent().addClass("km_primary_border"),jQuery(".km_filter_types #km_wrap_fieldday_all_tab_id").parent().addClass("active")),t.removeQueryParam(i);let n=!1;var o="MM-DD-YYYY "+fieldday.km_get_utc_string_func();if(!1===n){n=!0;var d=new FormData(e("#km_session_filter_form")[0]);let a=document.querySelector('.km_active_filters .km_tags a[data-filter-key="fromDate"]'),s=document.querySelector('.km_active_filters .km_tags a[data-filter-key="toDate"]');if(a||s){let t=e("#reportrange").data("daterangepicker"),i=t.startDate.format(o),r=t.endDate.format("MM-DD-YYYY 23:59:59");new Date(i)>new Date(r)&&(i=t.endDate.format(o),r=t.startDate.format("MM-DD-YYYY 23:59:59")),a&&d.append("filters[fromDate]",i),s&&d.append("filters[toDate]",r)}else if(e("#reportrange").length>0&&""!=jQuery("#km_if_session_filter_date").val()){let a=e("#reportrange").data("daterangepicker"),t=a.startDate.format(o),s=a.endDate.format("MM-DD-YYYY 23:59:59");new Date(t)>new Date(s)?(t=a.endDate.format(o),s=a.startDate.format("MM-DD-YYYY 23:59:59"),d.append("filters[fromDate]",t),d.append("filters[toDate]",s)):(d.append("filters[fromDate]",t),d.append("filters[toDate]",s))}t.postFormData(fieldday_ajax.ajax_url+"?action=km_filtersession",d,function(a){if("success"==a.status){e(".km_provider_sessions").show(),e(".km_provider_merchandise").hide(),e(".km_provider_sessions").html(a.content),t.fielddaySessionTime(),n=!1,0==e(".km_session_single_item").length?e("#km_nosession_message").removeClass("km_hidden"):e("#km_nosession_message").addClass("km_hidden"),(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<1024&&e(".removefilterselecter").length&&e(".removefilterselecter").click()}else"fail"==a.status&&t.DisplayAlert("error",a.message)})}},FilterSessions:function(){e("#km_session_search_keyword").on("keyup",function(a){var s=document.getElementById("#km_session_search_keyword");clearTimeout(f),f=setTimeout(function(){e("#km_session_filter_form").length&&t.processSessionFilters(s,a)},2e3)}),jQuery(".typescontent label").click(function(){jQuery(".typescontent label").removeClass("active"),jQuery(".typescontent label").removeClass("km_primary_border"),jQuery(this).addClass("active"),jQuery(this).addClass("km_primary_border")}),e("#km_session_search_keyword").on("keydown",function(e){clearTimeout(f)}),e(document).on("click",".km_clear_session_filters",function(){var e=document.getElementById("km_session_filter_form");if(e){t.setCookie("km_purchase_location_form","all"),jQuery("#km_session_filter_form")[0].reset();moment(),moment().add(365,"days");jQuery("#km_if_session_filter_date").length&&(jQuery("#km_if_session_filter_date").val(""),jQuery("#reportrange span").text("Select Date")),jQuery("#reportrange").length&&jQuery("#reportrange span").text("Select Date");var a=new FormData(e);t.postFormData(fieldday_ajax.ajax_url+"?action=km_filtersession",a,function(e){if("success"==e.status){jQuery(".km_provider_sessions").show(),jQuery(".km_provider_merchandise").hide(),jQuery(".km_provider_sessions").html(e.content),t.fielddaySessionTime(),isProcessing=!1,0==jQuery(".km_session_single_item").length?jQuery("#km_nosession_message").removeClass("km_hidden"):jQuery("#km_nosession_message").addClass("km_hidden"),(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<1024&&jQuery(".removefilterselecter").length&&jQuery(".removefilterselecter").click()}else"fail"==e.status&&t.DisplayAlert("error",e.message)})}}),e(document).on("click",".km_reset_filter",function(){let a=e(this).data("filter-key"),s="all";"searchKey"==a&&(s=""),"radio"==e('input[data-search-name="'+a+'"]').attr("type")?(e('[data-search-name="'+a+'"]').prop("checked",!1),e('[data-search-name="'+a+'"][value="'+s+'"]').prop("checked",!0)):e('[data-search-name="'+a+'"]').val(s),t.removeQueryParam(a),"location"==a&&t.setCookie("km_purchase_location_form",s),"toDate"==a&&e('.km_active_filters .km_tags a[data-filter-key="toDate"]').parent().remove(),"fromDate"==a&&(jQuery("#km_if_session_filter_date").val(""),jQuery("#reportrange span").text("Select Date"),e('.km_active_filters .km_tags a[data-filter-key="fromDate"]').parent().remove(),e('.km_active_filters .km_tags a[data-filter-key="toDate"]').parent().remove()),e("#km_session_filter_form").length&&t.processSessionFilters()})},mobileSessionTabs:function(a,s){let i=e(a).val();"bankDays"==i?t.showMerchandise(a,s):(s.preventDefault(),e("#km_session_tab_id").val(i),e("#km_session_filter_form").length&&t.processSessionFilters())},showMerchandise:function(a,s){e(".km_session_tab").removeClass("km_active_tab"),e(".km_session_tab").removeClass("km_primary_color"),e(s).addClass("km_active_tab"),e(s).addClass("km_primary_color"),t.makeCall(fieldday_ajax.ajax_url,{action:"km_get_bankdays"},function(a){"success"==a.status?e(".km_provider_sessions").html(a.content).show():"fail"==a.status&&t.DisplayAlert("error",a.message)})},showGiftCards:function(a,s){e("#reportrange").hasClass("activebtn")&&e("#reportrange").removeClass("activebtn"),e(".km_session_tab").removeClass("km_active_tab"),e(".km_session_tab").removeClass("km_primary_color"),e(s).addClass("km_active_tab"),e(s).addClass("km_primary_color"),t.makeCall(fieldday_ajax.ajax_url,{action:"km_get_giftcards"},function(a){"success"==a.status?e(".km_provider_sessions").html(a.content).show():"fail"==a.status&&t.DisplayAlert("error",a.message)})},km_loader:function(){e(".km_loader_full").length?e(".km_loader_full").show():(e("body").append(t.settings.loader),e(".km_loader_full").show())},kmRemoveLoader:function(){e(".km_loader_full").hide()},km_btn_loader:function(a=""){if(a&&""!=a){e("#"+a).addClass("km_btn_active_loading");let t=e("#"+a).find(".km_btn_i_cls");t&&t.removeClass("km_hidden")}},km_btn_RemoveLoader:function(a=""){if(a&&""!=a){e("#"+a).removeClass("km_btn_active_loading");let t=e("#"+a).find(".km_btn_i_cls");t&&t.addClass("km_hidden")}},GetQueryString:function(e){var a,t,s=window.location.search.substring(1).split("&");if(s)for(t=0;t<s.length;t++)if((a=s[t].split("="))[0]===e)return void 0===a[1]||decodeURIComponent(a[1]);return!1},removeQueryParam:function(e){var a=window.location.href,t=a.split("?");if(1===t.length||-1===a.indexOf(e))return a;var s=t[1].split("&").filter(function(a){return 0!==a.indexOf(e)}).join("&");if(s)var i=t[0]+"?"+s;else i=t[0];void 0!==history.pushState?history.pushState({},"",i):window.location.assign(i)},viewSessionDetail:function(a,s){let i="";e("#km_session_tags").length?(i=e("#km_session_tags").val(),i=JSON.parse(i)):i="",t.makeCall(fieldday_ajax.ajax_url,{sessionId:a,tags:i,type:s,action:"km_session_detail"},function(e){"success"==e.status?(t.displayModal(e,"modal-large modal-sdetail"),t.initSlickSlider(),t.fielddaySessionTime(),t.addParamToUrl("sessionId",a),t.kmTooltip()):(t.DisplayAlert("error",e.message),t.closepopup())})},addParamToUrl:function(e,a){let s=t.addQueryVar(fieldday_ajax.permalink,e,a);void 0!==history.pushState?history.pushState({},"",s):window.location.assign(s)},sessionBookingOptions:function(a){let s=e("#km_session_tags").val();t.makeCall(fieldday_ajax.ajax_url,{sessionId:a,tags:JSON.parse(s),action:"km_session_booking_options"},function(e){"success"==e.status?(t.displayModal(e),t.initSlickSlider()):(t.DisplayAlert("error",e.message),t.closepopup())})},scrollTo:function(a,t){t||(t="html, body"),e(a).length&&e(t).animate({scrollTop:e(a).offset().top},1e3)},scrollInModal:function(e,a){var t=jQuery(e),s=jQuery(a),i="";if((window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<1024)i=100;else i=15;var r=s.offset().top-t.offset().top+t.scrollTop()-i;t.scrollTop(r)},StickyformVisibility:function(){"close"==t.getCookie("km_stickyform")&&(e(".km_sticky_icon").addClass("km_sticky_open"),e(".km_sticky_icon").removeClass("km_sticky_close "),e(".km_sticky_content").addClass("km_hidden_sticky"))},LocationPopUpformVisibility:function(){let a=t.getCookie("km_purchase_location_form");fieldday_ajax.isEnabledLocationPopUpPurchasePage&&e("#km_session_filter_form").length&&(null==a?t.postFormData(fieldday_ajax.ajax_url+"?action=km_LocationPopUpformVisibility",[],function(a){"success"==a.status&&""!=a.content&&e("body").append(a.content)}):setTimeout(function(){e("#km_location_search").val(a),t.processSessionFilters()},1e3))},SetLocationPopUpformVisibility:function(a="all"){t.setCookie("km_purchase_location_form",a),e("#km_location_search").val(a),t.processSessionFilters(),e(".km_locationpopup_pc_overlay").remove(),e(".km_locationpopup_pc").remove()},initSlickSlider:function(){e(".km_slides").length&&e(".km_slides:not('.slick-initialized')").slick({dots:!1,arrows:!0,infinite:!1,cssEase:"linear"})},submitDonation:function(a,s){s.preventDefault();var i=e(a).parents("form");i.parsley(t.settings.parsley_valiation_options).whenValidate({group:"km_donate"}).done(function(){e(a).prop("disabled",!0),t.StripeProcess(i,function(s){if(s.error)t.DisplayAlert("error",s.error.message),t.kmRemoveLoader();else{i.find(".stripe_token").val(s.id);var r=new FormData(i[0]);e(button).prop("disabled",!0),t.postFormData(fieldday_ajax.ajax_url+"?action=km_submit_donation",r,function(s){"success"==s.status?(i[0].reset(),t.displayModal(s)):"fail"==s.status&&t.DisplayAlert("error",s.message),e(a).prop("disabled",!1)})}e(a).prop("disabled",!1)})})},makeCall:function(a,s,i,r){a=t.addQueryVar(a,"permalink",fieldday_ajax.permalink),a=t.addQueryVar(a,"_wpnonce",fieldday_ajax._wpnonce),e.ajax({url:a,type:"POST",data:s,datatype:"json",async:!0,crossDomain:!0,beforeSend:function(e){r||t.km_loader()},success:function(e){r||t.km_loader(),i(e)},complete:function(){r||t.kmRemoveLoader()},error:function(e,a,s){t.kmRemoveLoader()}})},postFormData:function(a,s,i,r,n=""){n&&""!=n&&t.km_btn_loader(n),t.km_loader(),a=t.addQueryVar(a,"permalink",fieldday_ajax.permalink),a=t.addQueryVar(a,"_wpnonce",fieldday_ajax._wpnonce),e.ajax({url:a,type:"POST",data:s,datatype:"json",beforeSend:function(e){r||t.km_loader(),n&&""!=n&&t.km_btn_loader(n)},success:function(e){i(e)},complete:function(){r||t.kmRemoveLoader(),n&&""!=n&&t.km_btn_RemoveLoader(n)},error:function(e,a,s){t.kmRemoveLoader(),n&&""!=n&&t.km_btn_RemoveLoader(n)},cache:!1,contentType:!1,processData:!1})},addQueryVar:function(e,a,t){var s=new RegExp("([?&])"+a+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+a+"="+t+"$2"):e+i+a+"="+t},initilaizeDaterangepicker:function(){var a=moment(),t=moment().add(365,"days");function s(a,t){e("#reportrange span").html("Select Date")}e("#reportrange").daterangepicker({startDate:a,endDate:t,minDate:moment(),ranges:{Today:[moment(),moment().startOf("hour").add(23,"hour")],"Next 7 Days":[moment().startOf("hour").add(15,"hour").add(6,"days"),moment()],"Next Month":[moment().add(1,"month").startOf("month"),moment().add(1,"month").endOf("month")]}},s),s()},SessionlistVeiw:function(){e(".km_session_switcher").on("click",function(a){e(".km_session_switcher").removeClass("km_current_layout");var t=e(this).data("style");e(this).addClass("km_current_layout"),"grid"==t?e(".km_shadow_right").removeClass("km_session_list"):e(".km_shadow_right").removeClass("km_session_grid"),e(".km_shadow_right").addClass("km_session_"+t)});let a=!1;e(document).scroll(function(){e(this).scrollTop()<50&&(a=!1),a&&t.inRange(e(this).scrollTop(),45,55)||(e(this).scrollTop()>50?(a=!0,e(".km_sessions_header").addClass("km_session_sticky_header")):(a=!1,e(".km_sessions_header").removeClass("km_session_sticky_header")))}),e(".km_discount_button").on("click",function(){t.setCookie("discount_check",!0),e("#km_modal_discount").hide()}),e(".km_global_pop_btn").on("click",function(a){a.preventDefault(),t.setCookie(fieldday_ajax.global_popup_key,!0),e("#km_modal_discount_global").hide();let s=e(this).attr("href");s&&(window.location.href=s)}),e(".km_session_tab").on("click",function(a){a.preventDefault();let s=e(this).data("id");e(".km_session_tab, .km_session_tab_merchandise").removeClass("km_active_tab"),e(".km_session_tab, .km_session_tab_merchandise").removeClass("km_primary_color"),e("#km_session_tab_id").val(s),e(this).addClass("km_active_tab"),e(this).addClass("km_primary_color"),e("#km_session_filter_form").length&&t.processSessionFilters()}),e("#reportrange").on("apply.daterangepicker",function(a,s){e(this).hasClass("activebtn")&&e(this).removeClass("activebtn"),jQuery("#km_if_session_filter_date").val("1"),jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").hasClass("active")&&(jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").removeClass("active"),jQuery(".km_filter_types #km_wrap_fieldday_gft_tab_id").removeClass("km_primary_border"),jQuery(".km_filter_types #km_wrap_fieldday_all_tab_id").parent().addClass("km_primary_border"),jQuery(".km_filter_types #km_wrap_fieldday_all_tab_id").parent().addClass("active"));var i=e("#reportrange").data("daterangepicker"),r="MM-DD-YYYY "+fieldday.km_get_utc_string_func(),n=i.startDate.format(r),o=i.endDate.format("MM-DD-YYYY 23:59:59");if(new Date(n)>new Date(o)){n=i.endDate.format(r),o=i.startDate.format("MM-DD-YYYY 23:59:59");e("#reportrange span").html(s.endDate.format("MMMM D, YYYY")+" - "+s.startDate.format("MMMM D, YYYY"))}else e("#reportrange span").html(s.startDate.format("MMMM D, YYYY")+" - "+s.endDate.format("MMMM D, YYYY"));var d=new FormData(e("#km_session_filter_form")[0]);d.append("filters[fromDate]",n),d.append("filters[toDate]",o),t.postFormData(fieldday_ajax.ajax_url+"?action=km_filtersession",d,function(a){if("success"==a.status){e(".km_provider_sessions").show(),e(".km_provider_merchandise").hide(),e(".km_provider_sessions").html(a.content),t.fielddaySessionTime(),isProcessing=!1,0==e(".km_session_single_item").length?e("#km_nosession_message").removeClass("km_hidden"):e("#km_nosession_message").addClass("km_hidden")}else"fail"==a.status&&t.DisplayAlert("error",a.message)})});var s=(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<1024,i=new Date;i.getDate(),i.getMonth(),i.getFullYear();e("#km_events_calendar").fullCalendar({views:{day:{titleFormat:"YYYY, MM, DD"}},header:{left:"",center:"title"},dayRender:function(e,a){if(s){var i=e.format("MM-DD-YYYY"),r=t.convertTimeToLocal(i+" 05:00","dddd"),n=a.attr("data-date");a.parents(".fc-row").find(".fc-content-skeleton").find("tr").find('td[data-date="'+n+'"]').find(".fc-day-number").append('<span class="all-weekday">'+r.slice(0,3)+"</span>")}},eventRender:function(e,a,t){console.log(e)},events:function(a,i,r,n){var o=jQuery("div#km_events_calendar").fullCalendar("getDate"),d="MM-DD-YYYY "+fieldday.km_get_utc_string_func();jQuery.ajax({url:fieldday_ajax.ajax_url+"?action=km_calenderevents",type:"POST",dataType:"json",data:{start:o.format(d),end:i.format("MM-DD-YYYY 23:59:59")},success:function(a){console.log("successevent: "+a);var i=[];e.each(a,function(r,n){let o=a[r].start_fulldate,d=a[r].end_fulldate,_=t.convertTimeToLocal(o,"YYYY-MM-DD"),l=t.convertTimeToLocal(d,"YYYY-MM-DD"),m=t.convertTimeToLocal(o,"h:mm a"),c=t.convertTimeToLocal(d,"h:mm a");i.push({id:a[r].id,title:a[r].title,start:_,end:l});var p=e("td .fc-day-top");e.each(p,function(){var i=e(this).attr("data-date"),n=t.convertTimeToLocal(i+" 05:00","dddd");let o=t.settings.DaysArray.indexOf(n);if(i<=l&&i>=_&&(e(this).attr("data-weekday",n),e.inArray(o,a[r].days)>-1))if(s){e(this).append('<div class="eventtitle km_session_single_item" data-time-stamp-from="'+a[r].starttimestamp+'" data-time-stamp-to="'+a[r].endtimestamp+'" ><span class="km_event_time">'+m+"-"+c+'</span><a class="km_eventclick" href="javascript:void(0);" data_eventid="'+a[r].id+'" ><span style="color:#'+a[r].title_color+';display: block;font-weight: bold;">'+a[r].title+"</span></a></div>");var d=e(".eventtitle").length,p=document.querySelector(".eventtitle").offsetHeight;e(".fc-view.fc-agendaDay-view.fc-agenda-view .fc-row.fc-week.fc-widget-content").css("height",p*d+50)}else e(this).find(".fc-day-number").after('<div class="eventtitle km_session_single_item" style="margin: 5px 3px;" data-time-stamp-from="'+a[r].starttimestamp+'" data-time-stamp-to="'+a[r].endtimestamp+'" ><span class="km_event_time">'+m+"-"+c+'</span><a class="km_eventclick" href="javascript:void(0);" data_eventid="'+a[r].id+'" ><span style="color:#'+a[r].title_color+';display: block;font-weight: bold;white-space: break-spaces;">'+a[r].title+"</span></a></div>")})})}})}}),e("#km_events_calendar_detailed").fullCalendar({views:{day:{titleFormat:"YYYY, MM, DD"}},header:{left:"",center:"title"},dayRender:function(e,a){if(s){var i=e.format("MM-DD-YYYY"),r=t.convertTimeToLocal(i+" 05:00","dddd"),n=a.attr("data-date");a.parents(".fc-row").find(".fc-content-skeleton").find("tr").find('td[data-date="'+n+'"]').find(".fc-day-number").append('<span class="all-weekday">'+r.slice(0,3)+"</span>")}},eventRender:function(e,a,t){console.log(e),a.attr("title",e.tooltip)},eventMouseover:function(a,t){var s=e('<div class="tooltipevent" style="width:100px;height:100px;background:#ccc;position:absolute;z-index:10001;">dasdasds</div>').appendTo("body");e(this).mouseover(function(a){e(this).css("z-index",1e4),s.fadeIn("500"),s.fadeTo("10",1.9)}).mousemove(function(e){s.css("top",e.pageY+10),s.css("left",e.pageX+20)})},eventMouseout:function(a,t){e(this).css("z-index",8),e(".tooltipevent").remove()},events:function(a,s,i,r){var n=jQuery("div#km_events_calendar_detailed").fullCalendar("getDate"),o="MM-DD-YYYY "+fieldday.km_get_utc_string_func();jQuery.ajax({url:fieldday_ajax.ajax_url+"?action=km_calenderevents",type:"POST",dataType:"json",data:{start:n.format(o),end:s.format("MM-DD-YYYY 23:59:59")},success:function(a){console.log("successevent: "+a);var s=[];e.each(a,function(i,r){let n=a[i].start_fulldate,o=a[i].end_fulldate,d=t.convertTimeToLocal(n,"YYYY-MM-DD"),_=t.convertTimeToLocal(o,"YYYY-MM-DD"),l=t.convertTimeToLocal(n,"h:mm a"),m=t.convertTimeToLocal(o,"h:mm a");s.push({id:a[i].id,title:a[i].title,start:d,end:_});var c=e("td .fc-day-top");e.each(c,function(){var s=e(this).attr("data-date"),r=t.convertTimeToLocal(s+" 05:00","dddd");let n=t.settings.DaysArray.indexOf(r);s<=_&&s>=d&&(e(this).attr("data-weekday",r),e.inArray(n,a[i].days)>-1&&(e(this).addClass("hasEvent"),e(this).find(".fc-day-number").after('<div class="eventtitle km_eventclick km_session_single_item km_hidden km_row" data_eventid="'+a[i].id+'"  style="margin: 5px 3px;" data-time-stamp-from="'+a[i].starttimestamp+'" data-time-stamp-to="'+a[i].endtimestamp+'" ><div class="km_col_8"><i class="fa fa-clock km_primary_color" aria-hidden="true"></i> <span class="km_event_time">'+l+"-"+m+'</span><a class="km_eventclick km_primary_color" href="javascript:void(0);" data_eventid="'+a[i].id+'" ><span style="display: block;font-weight: bold;white-space: break-spaces;">'+a[i].title+'</span></a></div><div class="km_col_4"><span class="km_event_btn km_primary_bg">View Detail</span></div></div>')));var o=e(this).find(".eventtitle").length;e(this).attr("total-events",o)})})}})}}),e(document).ajaxStop(function(){e(".fc-future.hasEvent, .fc-today.hasEvent").mouseenter(function(){var a=e(this).attr("total-events");e(this).append('<div class="km-event_tooltip">'+a+" Available</div>"),e(this).find(".fc-day-number").addClass("km_secondary_border")}),e(".fc-future.hasEvent, .fc-today.hasEvent").mouseleave(function(){e(this).find(".km-event_tooltip").remove(),e(this).find(".fc-day-number").removeClass("km_secondary_border")}),e("body").on("click",".fc-future, .fc-today",function(a){e(".fc-day-number").removeClass("km_secondary_bg"),e(".fc-future, .fc-today").removeClass("km-clicked-event"),e(this).addClass("km-clicked-event"),e(this).find(".fc-day-number").addClass("km_secondary_bg");var i=e(".km_full-sessions").attr("data-day");if(e(".km_full-sessions").remove(),e(this).hasClass("hasEvent")){a.stopImmediatePropagation(),console.log("today-clicked");var r=e(this).find(".eventtitle").clone(),n=e(this).data("date"),o=moment(n).format("DD-MM-YYYY"),d=e(this).find(".fc-day-number").text();s?(e(this).append('<div class="km_full-sessions"><div class="km_loader_full"></div><h3 class="km_primary_color km_cal_heading">Available Sessions '+o+"</h3></div>"),e(this).find(".km_full-sessions").append(r)):(e(this).parents(".fc-week").append('<div class="km_full-sessions"><div class="km_loader_full"></div><h3 class="km_primary_color km_cal_heading">Available Sessions on '+o+"</h3></div>"),e(this).parents(".fc-week").find(".km_full-sessions").append(r)),e(".km_full-sessions").attr("data-day",d),i===d?e(".km_full-sessions").addClass("km_hidden"):(t.km_loader(),setTimeout(function(){e(".km_full-sessions .eventtitle").removeClass("km_hidden"),t.kmRemoveLoader()},2e3))}})}),e(document).ajaxStop(function(){e("body").on("click",".km_eventclick",function(a){a.stopPropagation(),a.stopImmediatePropagation();var s=e(this).attr("data_eventid");t.makeCall(fieldday_ajax.ajax_url,{sessionId:s,action:"km_session_detail"},function(e){"success"==e.status?(t.displayModal(e,"modal-large"),t.initSlickSlider(),t.fielddaySessionTime(),t.kmTooltip()):(t.DisplayAlert("error",e.message),t.closepopup())})})}),e(document).ajaxStop(function(){e("body").on("click",".removecartselecter",function(e){e.stopPropagation(),jQuery("#km_cart_items_wrap").css({right:"-370px"}),jQuery("#km_cart_items_wrap_mobile").css({top:"5000px"})})}),e("body").on("click","#sharesession",function(a){var s=document.body.appendChild(document.createElement("input")),i=e(this).parents(".km_package_wrapper").find(".km_booking_type a").attr("href").replace("_id","sessionId");s.value=i,s.select(),document.execCommand("copy"),s.parentNode.removeChild(s),t.DisplayAlert("success","Session link has been copied")})},convertTimeToLocal:function(e,a){return moment.utc(e).local().format(a)},filterByTag:function(a,s){"SELECT"==e(a).prop("tagName")?e("#km_session_filter_form").length&&t.processSessionFilters():(e(".km_radio_wrap_filterd").removeClass("km_active_filter"),e(".km_radio_wrap_filterd").removeClass("km_primary_bg"),e(a).parents(".km_radio_wrap_filterd").addClass("km_active_filter"),e(a).parents(".km_radio_wrap_filterd").addClass("km_primary_bg"),e("#km_session_filter_form").length&&t.processSessionFilters())},Myaccountpageevents:function(){e(".close_before_account_text").on("click",function(){t.setCookie("display_account_help",!0),e(".km_before_account_text").remove()}),e(".km_my_account_slidefilter_btn a").click(function(){e(".km_view_all_prctpants_pg_ctm_new").length&&e(".km_view_all_prctpants_pg_ctm_new").toggleClass("open-sidebar")})},radiobuttonevent:function(a,t){"true"==e(a).attr("previousValue")?(a.checked=!1,e(a).attr("previousValue",a.checked)):(a.checked=!0,e(a).attr("previousValue",a.checked))},giftCardswitchevent:function(){e("body").on("click",".km_single_giftcardpopup .km_single_giftdesign img",function(a){a.preventDefault();let t=e(this).parent(".km_single_giftdesign").index();localStorage.setItem("kmGiftCardPurchaseData_gft_img",t),e(".km_single_giftdesign").removeClass("selectedCartItem");var s=e(this).data("original"),i=e(this).attr("src");e(".km_single_giftcardpopup .km_gift_image").attr("src",i),e(".km_single_giftcardpopup .km_gift_image").attr("data-original",s),e(this).parent(".km_single_giftcardpopup .km_single_giftdesign").addClass("selectedCartItem")}),e("body").on("click",".km_gift_value",function(a){a.preventDefault(),e(".giftcardprice").text(""),e('input[name="km_gift_custom_amount"]').val(""),e("span.km_gift_value.selectedCartItem").removeClass("km_primary_border"),e("span.km_gift_value.selectedCartItem").removeClass("selectedCartItem");var t=e(this).text();""==t.trim()?(e("input#km_gift_custom_amount").keyup(function(){if(t=this.value,e(".a-alert-content").text(""),/\D/g.test(this.value))this.value=this.value.replace(/\D/g,"");else{var a=parseInt(e(this).attr("max"));parseInt(e(this).attr("min"));if(e(this).val()>a||e(this).val(),t)var s="$"+parseFloat(t).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");else s="";e(".giftcardprice").text(s),e(".input#km_gift_custom_amount").val(s),e('input[name="km_gift_custom_amount"]').val(s)}}),e(this).addClass("selectedCartItem"),e(this).addClass("km_primary_border")):(e(".giftcardprice").text(t),e('input[name="km_gift_custom_amount"]').val(t.trim()),e(this).addClass("selectedCartItem"),e(this).addClass("km_primary_border"))}),e("body").on("click",".km_sendoption_value",function(a){a.preventDefault(),e("span.km_sendoption_value.selectedCartItem").removeClass("km_primary_border"),e("span.km_sendoption_value.selectedCartItem").removeClass("selectedCartItem"),e(this).addClass("selectedCartItem"),e(this).addClass("km_primary_border"),"Email"!=jQuery("span.km_sendoption_value.selectedCartItem").text()?e("span#phone_number").css("display","block"):e("span#phone_number").css("display","none")})},passwordHideShowevent:function(){e("body").on("click","#togglePassword",function(a){var t=document.querySelector("[name='user_password']");null===t&&(t=document.querySelector("[name='user-register-password']"));const s="password"===t.getAttribute("type")?"text":"password";t.setAttribute("type",s),"text"==s?e(this).addClass("fa-eye").removeClass("fa-eye-slash"):e(this).addClass("fa-eye-slash").removeClass("fa-eye")})}}).initilaize()}(jQuery);